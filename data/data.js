// data/data.js

// ==========================================
// PART 1: GENERATORS
// ==========================================
window.getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
window.getRandomFloat = (min, max, decimals) => parseFloat((Math.random() * (max - min) + min).toFixed(decimals));
window.getRandomItem = (arr) => arr[Math.floor(Math.random() * arr.length)];
window.clamp = (val, min, max) => Math.min(Math.max(val, min), max);

window.generateName = (sex) => {
    const male = ["James", "John", "Robert", "Michael", "William", "David", "Richard", "Joseph", "Thomas", "Charles", "George", "Harry", "Jack", "Oliver", "Noah", "Arthur", "Leo"];
    const female = ["Mary", "Patricia", "Jennifer", "Linda", "Elizabeth", "Barbara", "Susan", "Jessica", "Sarah", "Karen", "Olivia", "Amelia", "Isla", "Ava", "Mia", "Grace", "Lily"];
    const sur = ["Smith", "Jones", "Williams", "Taylor", "Brown", "Davies", "Evans", "Wilson", "Thomas", "Johnson", "Roberts", "Robinson", "Thompson", "Wright", "Walker", "White", "Edwards", "Hughes", "Green", "Hall"];
    const first = sex === 'Female' ? window.getRandomItem(female) : window.getRandomItem(male);
    return `${first} ${window.getRandomItem(sur)}`;
};

window.generateHistory = (age, sex = 'Male') => {
    if (age < 20) return { pmh: ["Nil significant"], dhx: ["Nil"], allergies: ["Nil"] };
    const commonPMH = ["Hypertension", "Type 2 Diabetes", "Asthma", "Hyperlipidaemia", "GORD", "Depression", "Anxiety", "Previous MI", "AF", "CKD Stage 3"];
    const femalePMH = ["PCOS", "Endometriosis", "Previous C-Section"];
    let pmh = []; let dhx = [];
    const pmhCount = age > 60 ? window.getRandomInt(1, 4) : age > 40 ? window.getRandomInt(0, 2) : window.getRandomInt(0, 1);
    for(let i=0; i<pmhCount; i++) { const item = window.getRandomItem(commonPMH); if(!pmh.includes(item)) pmh.push(item); }
    if (sex === 'Female' && Math.random() > 0.8) pmh.push(window.getRandomItem(femalePMH));
    if (pmh.includes("Hypertension")) dhx.push("Ramipril 5mg OD");
    if (pmh.includes("Type 2 Diabetes")) dhx.push("Metformin 1g BD");
    if (pmh.includes("Asthma")) dhx.push("Salbutamol PRN", "Beclometasone BD");
    if (pmh.includes("Hyperlipidaemia")) dhx.push("Atorvastatin 20mg ON");
    if (pmh.includes("GORD")) dhx.push("Omeprazole 20mg OD");
    if (pmh.includes("AF")) dhx.push("Bisoprolol 2.5mg OD", "Edoxaban 60mg OD");
    if (pmh.includes("Previous MI")) dhx.push("Aspirin 75mg OD", "Atorvastatin 80mg ON", "Bisoprolol 2.5mg OD");
    if (pmh.length === 0) pmh.push("Nil significant");
    if (dhx.length === 0) dhx.push("Nil regular medications");
    return { pmh: pmh, dhx: dhx, allergies: [Math.random() > 0.8 ? window.getRandomItem(["Penicillin", "Latex", "NSAIDs", "Trimethoprim"]) : "NKDA"] };
};

window.getBaseVitals = (age) => {
    let v = { hr: 75, rr: 16, bpSys: 120, bpDia: 75, temp: 36.8, bm: 5.8, gcs: 15, pupils: 3 }; 
    if (age < 1) v = { hr: 145, rr: 45, bpSys: 75, bpDia: 45, temp: 37.0, bm: 4.5, gcs: 15, pupils: 3 }; 
    else if (age <= 2) v = { hr: 125, rr: 30, bpSys: 90, bpDia: 55, temp: 37.0, bm: 5.0, gcs: 15, pupils: 3 }; 
    else if (age <= 5) v = { hr: 110, rr: 25, bpSys: 95, bpDia: 60, temp: 37.0, bm: 5.0, gcs: 15, pupils: 3 }; 
    else if (age <= 12) v = { hr: 90, rr: 20, bpSys: 105, bpDia: 65, temp: 36.8, bm: 5.5, gcs: 15, pupils: 4 }; 
    else if (age > 65) v = { hr: 70, rr: 18, bpSys: 135, bpDia: 80, temp: 36.5, bm: 6.0, gcs: 15, pupils: 3 }; 
    return v;
};

window.estimateWeight = (age) => {
    if (age < 0) return null;
    if (age === 0) return "3.5"; 
    if (age < 1) return "6.0"; 
    if (age >= 1 && age <= 10) return Math.round((age + 4) * 2); 
    if (age > 10 && age < 16) return Math.round(age * 3 + 7); 
    return null; 
};

window.calculateWetflag = (age, weightStr) => {
    const weight = parseFloat(weightStr);
    if (isNaN(weight) || weight <= 0) return null;
    let rawTube = (age / 4) + 4;
    let tubeSize = Math.round(rawTube * 2) / 2;
    if (age < 1) tubeSize = "3.5-4.0"; 
    else if (tubeSize > 9.0) tubeSize = 9.0;
    else if (tubeSize < 3.0) tubeSize = 3.0;
    let adrenalineMcg = Math.round(weight * 10);
    let glucoseVol = Math.round(weight * 2);
    return { 
        weight: weight, 
        energy: Math.round(weight * 4),
        tube: tubeSize.toString(), 
        fluids: Math.round(weight * 10),
        lorazepam: Math.min(4, weight * 0.1).toFixed(1),
        adrenaline: adrenalineMcg, 
        glucose: glucoseVol
    };
};

window.generateVbg = (clinicalState = "normal") => {
    let vbg = { pH: 7.40, pCO2: 5.3, HCO3: 24, BE: 0, Lac: 1.0, K: 4.0, Glu: 5.5, Ketones: 0.2 };
    vbg.pH += window.getRandomFloat(-0.03, 0.03, 2);
    switch (clinicalState) {
        case "dka_severe": vbg = { pH: 6.95, pCO2: 2.5, HCO3: 5, BE: -24, Lac: 2.5, K: 5.4, Glu: 28.0, Ketones: 5.8 }; break;
        case "septic_shock": vbg = { pH: 7.25, pCO2: 4.5, HCO3: 16, BE: -8, Lac: 6.5, K: 4.2, Glu: 4.0, Ketones: 0.5 }; break;
        case "haemorrhagic_shock": vbg = { pH: 7.20, pCO2: 4.8, HCO3: 14, BE: -10, Lac: 8.0, K: 3.8, Glu: 9.0, Ketones: 1.2 }; break;
        case "copd_retainer": vbg = { pH: 7.30, pCO2: 9.5, HCO3: 34, BE: 8, Lac: 1.2, K: 4.0, Glu: 6.0, Ketones: 0.2 }; break;
        case "respiratory_acidosis_acute": vbg = { pH: 7.15, pCO2: 9.5, HCO3: 24, BE: 0, Lac: 1.5, K: 4.1, Glu: 6.2, Ketones: 0.2 }; break;
        case "metabolic_acidosis_severe": vbg = { pH: 6.90, pCO2: 6.0, HCO3: 10, BE: -22, Lac: 12.0, K: 6.5, Glu: 6.0, Ketones: 0.4 }; break;
        case "metabolic_alkalosis": vbg = { pH: 7.50, pCO2: 5.8, HCO3: 30, BE: 6, Lac: 1.0, K: 3.0, Glu: 5.5, Ketones: 0.2 }; break;
        case "hyperkalemia": vbg = { pH: 7.35, pCO2: 5.0, HCO3: 22, BE: -2, Lac: 1.5, K: 7.5, Glu: 6.0, Ketones: 0.2 }; break;
        case "hyponatremia": vbg = { pH: 7.40, pCO2: 5.3, HCO3: 24, BE: 0, Lac: 1.2, K: 4.0, Na: 115, Glu: 5.5, Ketones: 0.2 }; break;
        case "gi_bleed": vbg = { pH: 7.32, pCO2: 4.8, HCO3: 20, BE: -4, Lac: 3.5, K: 4.1, Glu: 6.5, Ketones: 1.5 }; break; 
        case "hypercalcemia": vbg = { pH: 7.42, pCO2: 5.3, HCO3: 24, BE: 0, Lac: 1.2, K: 4.0, Ca: 3.5, Glu: 5.5, Ketones: 0.2 }; break;
        case "hypothermia": vbg = { pH: 7.30, pCO2: 5.0, HCO3: 22, BE: -2, Lac: 2.5, K: 3.5, Glu: 4.5, Ketones: 0.3 }; break;
        case "co_poisoning": vbg = { pH: 7.35, pCO2: 5.0, HCO3: 18, BE: -6, Lac: 4.0, K: 4.0, Glu: 6.0, Ketones: 0.2 }; break;
        default: break;
    }
    return vbg;
};

window.calculateDynamicVbg = (startVbg, currentVitals, activeInterventions, timeSeconds) => {
    if (!startVbg) return { pH: 7.4, pCO2: 5.0, HCO3: 24, Lac: 1.0, K: 4.0, Glu: 5.5, Ketones: 0.2 };
    let vbg = { ...startVbg };
    const minutes = timeSeconds / 60;
    const isVentilated = activeInterventions.has('Bagging') || activeInterventions.has('RSI') || activeInterventions.has('i-gel') || activeInterventions.has('NIV');
    if (currentVitals.rr < 10 && !isVentilated) { vbg.pCO2 = Math.min(15, vbg.pCO2 + (0.1 * minutes)); vbg.pH = Math.max(6.8, vbg.pH - (0.01 * minutes)); }
    if (isVentilated && vbg.pCO2 > 6.0) { vbg.pCO2 = Math.max(4.5, vbg.pCO2 - (0.2 * minutes)); vbg.pH = Math.min(7.4, vbg.pH + (0.02 * minutes)); }
    if (currentVitals.spO2 < 85 || currentVitals.bpSys < 80) { vbg.Lac = Math.min(15, vbg.Lac + (0.1 * minutes)); vbg.pH = Math.max(6.8, vbg.pH - (0.01 * minutes)); vbg.HCO3 = Math.max(10, vbg.HCO3 - (0.5 * minutes)); }
    if (activeInterventions.has('InsulinInfusion') || activeInterventions.has('InsulinDextrose')) {
        vbg.Ketones = Math.max(0.1, vbg.Ketones - (0.05 * minutes));
        vbg.Glu = Math.max(4.0, vbg.Glu - (0.1 * minutes));
    }
    return vbg;
};

window.HUMAN_FACTOR_CHALLENGES = [
  { id: 'hf0', type: 'Standard Simulation', description: 'Manage effectively.' },
  { id: 'hf1', type: 'Blindfolded Lead', description: 'Leader blindfolded. Tests closed-loop comms.' },
  { id: 'hf2', type: 'Silent Team', description: 'Only leader speaks.' },
  { id: 'hf3', type: 'New Junior', description: 'Junior member needs explicit instructions.' },
  { id: 'hf4', type: 'Missing Kit', description: 'Crucial equipment missing.' },
  { id: 'hf5', type: 'Distracted Senior', description: 'Consultant on phone, dismissive.' },
];

// ==========================================
// PART 2: INTERVENTIONS
// ==========================================
window.INTERVENTIONS = {
    // --- AIRWAY ---
    'Manoeuvres': { label: 'Head Tilt / Jaw Thrust', effect: { SpO2: 5 }, category: 'Airway', log: 'Airway manoeuvres applied.', type: 'continuous', duration: 5 },
    'OPA': { label: 'Guedel / OPA', effect: { SpO2: 5 }, category: 'Airway', log: 'Oropharyngeal airway inserted.', type: 'continuous', duration: 10 },
    'NPA': { label: 'Nasopharyngeal', effect: { SpO2: 5 }, category: 'Airway', log: 'Nasopharyngeal airway inserted.', type: 'continuous', duration: 15 },
    'i-gel': { label: 'i-gel / LMA', effect: { SpO2: 15, RR: 'vent' }, category: 'Airway', log: 'Supraglottic airway (i-gel) inserted.', type: 'continuous', duration: 30 },
    'Suction': { label: 'Suction', effect: { SpO2: 5 }, category: 'Airway', log: 'Airway suctioned.', type: 'bolus', duration: 15 },
    'RSI': { label: 'RSI / Intubation', effect: { SpO2: 99, RR: 'vent', BP: -15, gcs: 'sedated' }, category: 'Airway', log: 'Rapid Sequence Induction performed. Patient intubated.', type: 'continuous', duration: 120, requires: ['IV Access', 'Propofol', 'Roc'] },
    'FONA': { label: 'FONA', effect: { SpO2: 95, RR: 'vent' }, category: 'Airway', log: 'Emergency FONA performed. Airway secured.', type: 'continuous', duration: 60 },
    'Magills': { label: 'Magill Forceps', effect: { SpO2: 10 }, category: 'Airway', log: 'Foreign body removed with Magills.', type: 'bolus', duration: 15 },
    'ToggleETCO2': { label: 'Toggle ETCO2', effect: {}, category: 'Airway', log: 'ETCO2 monitoring toggled.', type: 'bolus', duration: 0 },

    // --- BREATHING ---
    'Oxygen': { label: 'High Flow O2', effect: { SpO2: 10 }, category: 'Breathing', log: 'High flow oxygen applied.', type: 'continuous', duration: 5 },
    'Bagging': { label: 'Bag-Valve-Mask', effect: { SpO2: 25, RR: 'vent' }, category: 'Breathing', log: 'Manual ventilation (BVM) started.', type: 'continuous', duration: 5 },
    'Nebs': { label: 'Nebs (Salb/Iprat)', effect: { HR: 10, RR: -3, SpO2: 5 }, category: 'Breathing', log: 'Nebulisers (Salbutamol/Ipratropium) administered.', type: 'bolus', duration: 300, requires: ['Oxygen'] },
    'NebAdrenaline': { label: 'Neb Adrenaline', effect: { HR: 10, RR: -5, SpO2: 5 }, category: 'Breathing', log: 'Nebulised Adrenaline running.', type: 'bolus', duration: 300, requires: ['Oxygen'] },
    'CPAP': { label: 'CPAP', effect: { SpO2: 10, RR: -5, BP: -5 }, category: 'Breathing', log: 'CPAP initiated.', type: 'continuous', duration: 60, requires: ['Oxygen'] },
    'NIV': { label: 'NIV (BiPAP)', effect: { SpO2: 12, RR: -5, BP: -5 }, category: 'Breathing', log: 'NIV (BiPAP) initiated.', type: 'continuous', duration: 60, requires: ['Oxygen'] },
    'Needle': { label: 'Needle Decompression', effect: { SpO2: 20, BP: 15, RR: -8 }, category: 'Breathing', log: 'Needle thoracocentesis performed.', type: 'bolus', duration: 30 },
    'FingerThoracostomy': { label: 'Finger Thoracostomy', effect: { SpO2: 20, BP: 15, RR: -8 }, category: 'Breathing', log: 'Finger thoracostomy performed.', type: 'bolus', duration: 60 },
    'SeldingerDrain': { label: 'Chest Drain (Seldinger)', effect: { SpO2: 15, BP: 10, RR: -5 }, category: 'Breathing', log: 'Seldinger chest drain inserted.', type: 'continuous', duration: 450 },
    'SurgicalDrain': { label: 'Chest Drain (Surgical)', effect: { SpO2: 15, BP: 10, RR: -5 }, category: 'Breathing', log: 'Surgical chest drain inserted.', type: 'continuous', duration: 600 },

    // --- CARDIAC & FLUIDS ---
    'PPCI': { label: 'PPCI Referral', effect: {}, category: 'Procedures', log: 'Urgent transfer for Primary PCI.', type: 'bolus', duration: 300 },
    'Furosemide': { label: 'Furosemide', effect: { BP: -5 }, category: 'Drugs', log: 'IV Furosemide administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Albumin': { label: 'Human Albumin Solution', effect: { BP: 5 }, category: 'Drugs', log: 'IV Albumin administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'AsciticTap': { label: 'Ascitic Tap', effect: {}, category: 'Procedures', log: 'Ascitic tap/paracentesis performed.', type: 'bolus', duration: 60 },
    'Hyperbaric': { label: 'Hyperbaric Referral', effect: {}, category: 'Procedures', log: 'Referral to hyperbaric unit made.', type: 'bolus', duration: 10 },
    
    // --- CIRCULATION ---
    'IV Access': { label: 'IV/IO Access', effect: {}, category: 'Circulation', log: 'IV/IO access secured.', type: 'continuous', duration: 30 },
    'Fluids': { label: 'Fluid Bolus', effect: { BP: 8, HR: -3 }, category: 'Circulation', log: 'Fluid bolus administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'Blood': { label: 'Blood (O Neg)', effect: { BP: 12, HR: -5 }, category: 'Circulation', log: 'O-Negative Blood administered.', type: 'bolus', duration: 300, requires: ['IV Access'] },
    'TXA': { label: 'TXA 1g', effect: {}, category: 'Circulation', log: 'IV Tranexamic Acid administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'AdrenalineIV': { label: 'Adrenaline 1mg (IV)', effect: { changeRhythm: 'chance' }, category: 'Circulation', log: 'IV Adrenaline administered.', type: 'bolus', duration: 5, requires: ['IV Access'] },
    'Amiodarone': { label: 'Amiodarone 300mg', effect: { changeRhythm: 'chance' }, category: 'Circulation', log: 'IV Amiodarone administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'Atropine': { label: 'Atropine 600mcg', effect: { HR: 20 }, category: 'Circulation', log: 'IV Atropine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Adenosine': { label: 'Adenosine 6/12/12', effect: { HR: 'reset' }, category: 'Circulation', log: 'IV Adenosine rapid bolus administered.', type: 'bolus', duration: 2, requires: ['IV Access'] },
    'Metaraminol': { label: 'Metaraminol', effect: { BP: 15 }, category: 'Circulation', log: 'IV Metaraminol bolus administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Noradrenaline': { label: 'Noradrenaline Infusion', effect: { BP: 20 }, category: 'Circulation', log: 'Noradrenaline infusion started.', type: 'continuous', duration: 300, requires: ['IV Access'] },
    'GTN': { label: 'GTN Spray', effect: { BP: -8 }, category: 'Circulation', log: 'GTN Spray sublingual administered.', type: 'bolus', duration: 5 },
    'GTNInfusion': { label: 'GTN Infusion', effect: { BP: -15 }, category: 'Circulation', log: 'GTN infusion started.', type: 'continuous', duration: 0, requires: ['IV Access'] },
    'FluidInfusion': { label: 'Fluid Infusion', effect: { BP: 5 }, category: 'Circulation', log: 'IV Fluid infusion started (Maintenance).', type: 'continuous', duration: 0, requires: ['IV Access'] },
    'Defib': { label: 'Defibrillation (Shock)', effect: { changeRhythm: 'defib' }, category: 'Circulation', log: 'Shock Delivered.', type: 'bolus', duration: 5, requires: ['PacingPads'] },
    'Cardioversion': { label: 'Sync Cardioversion', effect: { changeRhythm: 'sync' }, category: 'Circulation', log: 'Synchronised DC Shock delivered.', type: 'bolus', duration: 5, requires: ['PacingPads'] },
    'Pacing': { label: 'External Pacing', effect: { HR: 'pace' }, category: 'Circulation', log: 'External Pacing initiated.', type: 'continuous', duration: 10, requires: ['PacingPads'] },
    'Lucas': { label: 'Lucas Device', effect: { BP: 30 }, category: 'Circulation', log: 'Mechanical Chest Compression device applied.', type: 'continuous', duration: 30 },

    // --- DRUGS ---
    'Analgesia': { label: 'Morphine', effect: { HR: -5, RR: -3, BP: -2 }, category: 'Drugs', log: 'IV Morphine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Fentanyl': { label: 'Fentanyl', effect: { HR: -2, RR: -3, BP: -2 }, category: 'Drugs', log: 'IV Fentanyl administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Paracetamol': { label: 'Paracetamol IV', effect: {}, category: 'Drugs', log: 'IV Paracetamol administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Ketamine': { label: 'Ketamine', effect: { gcs: -5, BP: 5, HR: 5 }, category: 'Drugs', log: 'IV Ketamine administered.', type: 'bolus', duration: 15, requires: ['IV Access'] },
    'Midazolam': { label: 'Midazolam', effect: { gcs: -3 }, category: 'Drugs', log: 'IV Midazolam administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Lorazepam': { label: 'Lorazepam', effect: { gcs: -2 }, category: 'Drugs', log: 'IV Lorazepam administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Naloxone': { label: 'Naloxone', effect: { RR: 10, gcs: 5 }, category: 'Drugs', log: 'IV Naloxone administered.', type: 'bolus', duration: 5, requires: ['IV Access'] },
    'Antibiotics': { label: 'Co-Amoxiclav', effect: {}, category: 'Drugs', log: 'IV Co-Amoxiclav administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Ceftriaxone': { label: 'Ceftriaxone', effect: {}, category: 'Drugs', log: 'IV Ceftriaxone administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Tazocin': { label: 'Tazocin (Pip/Taz)', effect: {}, category: 'Drugs', log: 'IV Tazocin administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Gentamicin': { label: 'Gentamicin', effect: {}, category: 'Drugs', log: 'IV Gentamicin administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Antiemetic': { label: 'Ondansetron', effect: {}, category: 'Drugs', log: 'IV Ondansetron administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Cyclizine': { label: 'Cyclizine', effect: { HR: 5 }, category: 'Drugs', log: 'IV Cyclizine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'MagSulph': { label: 'Magnesium Sulphate', effect: { BP: -5, RR: -2 }, category: 'Drugs', log: 'IV Magnesium Sulphate administered.', type: 'bolus', duration: 600, requires: ['IV Access'] },
    'Calcium': { label: 'Calcium Gluconate', effect: { BP: 5 }, category: 'Drugs', log: 'IV Calcium Gluconate administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'InsulinDextrose': { label: 'Insulin/Dextrose', effect: { BM: 0 }, category: 'Drugs', log: 'Insulin/Dextrose bolus started (Hyperkalaemia).', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'Dextrose': { label: 'Glucose 10%', effect: { BM: 8 }, category: 'Drugs', log: 'IV Glucose/Dextrose administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'InsulinInfusion': { label: 'Insulin Infusion', effect: { BM: -2 }, category: 'Drugs', log: 'Fixed rate Insulin infusion started (0.1 u/kg/hr).', type: 'continuous', duration: 0, requires: ['IV Access'] },
    'Hydrocortisone': { label: 'Hydrocortisone', effect: { BP: 5 }, category: 'Drugs', log: 'IV Hydrocortisone administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Dexamethasone': { label: 'Dexamethasone', effect: {}, category: 'Drugs', log: 'IV Dexamethasone administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Aspirin': { label: 'Aspirin 300mg', effect: {}, category: 'Drugs', log: 'Aspirin PO administered.', type: 'bolus', duration: 10 },
    'Clopidogrel': { label: 'Clopidogrel', effect: {}, category: 'Drugs', log: 'Clopidogrel PO administered.', type: 'bolus', duration: 10 },
    'Ticagrelor': { label: 'Ticagrelor', effect: {}, category: 'Drugs', log: 'Ticagrelor PO administered.', type: 'bolus', duration: 10 },
    'Heparin': { label: 'Heparin / LMWH', effect: {}, category: 'Drugs', log: 'Anticoagulation administered.', type: 'bolus', duration: 10 },
    'Roc': { label: 'Rocuronium', effect: { RR: -50, paralysed: true }, category: 'Drugs', log: 'IV Rocuronium administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Sux': { label: 'Suxamethonium', effect: { RR: -50, paralysed: true }, category: 'Drugs', log: 'IV Suxamethonium administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Propofol': { label: 'Propofol', effect: { gcs: -5, BP: -10, RR: -5 }, category: 'Drugs', log: 'IV Propofol administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Pabrinex': { label: 'Pabrinex', effect: {}, category: 'Drugs', log: 'IV Pabrinex administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Glucagon': { label: 'Glucagon', effect: { HR: 15, BP: 5, BM: 3 }, category: 'Drugs', log: 'IV Glucagon administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'AdrenalineIM': { label: 'Adrenaline 500mcg (IM)', effect: { HR: 20, BP: 15 }, category: 'Drugs', log: 'IM Adrenaline administered.', type: 'bolus', duration: 5 },

    // --- PROCEDURES ---
    'Obs': { label: 'Monitoring', effect: {}, category: 'Procedures', log: 'Full monitoring applied.', type: 'continuous', duration: 10 },
    'ArtLine': { label: 'Arterial Line', effect: {}, category: 'Procedures', log: 'Arterial Line inserted.', type: 'continuous', duration: 180 },
    'Splinting': { label: 'Splint Limb', effect: { HR: -2 }, category: 'Procedures', log: 'Limb splinted.', type: 'continuous', duration: 120 },
    'Reduction': { label: 'Reduce Fracture', effect: { HR: -5, BP: -2 }, category: 'Procedures', log: 'Fracture reduction performed.', type: 'bolus', duration: 60 },
    'Collar': { label: 'C-Spine Collar', effect: {}, category: 'Procedures', log: 'C-spine collar applied.', type: 'continuous', duration: 30 },
    'Binder': { label: 'Pelvic Binder', effect: { BP: 8 }, category: 'Procedures', log: 'Pelvic binder applied.', type: 'continuous', duration: 60 },
    'Warming': { label: 'Active Warming', effect: { Temp: 1 }, category: 'Procedures', log: 'Bair hugger/Warming blanket applied.', type: 'continuous', duration: 300 },
    'Cooling': { label: 'Active Cooling', effect: { Temp: -1 }, category: 'Procedures', log: 'Active cooling measures started.', type: 'continuous', duration: 300 },
    'Irrigation': { label: 'Irrigation', effect: {}, category: 'Procedures', log: 'Copious irrigation started.', type: 'continuous', duration: 300 },
    'PacingPads': { label: 'Pacing Pads', effect: {}, category: 'Procedures', log: 'Defib/Pacing pads applied.', type: 'continuous', duration: 10 },

    // --- OBSTETRICS & SURGERY ---
    'Surgery': { label: 'Emergency Surgery', effect: {}, category: 'Procedures', log: 'Patient transferred to theatre.', type: 'bolus', duration: 300 },
    'Delivery': { label: 'Vaginal Delivery', effect: {}, category: 'Procedures', log: 'Baby delivered.', type: 'bolus', duration: 60 },
    'Hysterotomy': { label: 'Perimortem C-Section', effect: {}, category: 'Procedures', log: 'Perimortem C-Section performed.', type: 'bolus', duration: 60 },
    'Manoeuvres': { label: 'Manoeuvres', effect: {}, category: 'Procedures', log: 'Specialist manoeuvres (e.g. McRoberts) performed.', type: 'bolus', duration: 30 },
    'Oxytocin': { label: 'Oxytocin', effect: { BP: -5 }, category: 'Drugs', log: 'IV Oxytocin administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Ergometrine': { label: 'Ergometrine', effect: { BP: 10 }, category: 'Drugs', log: 'IV Ergometrine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Carboprost': { label: 'Carboprost', effect: {}, category: 'Drugs', log: 'IM Carboprost administered.', type: 'bolus', duration: 10 },
    'AntiD': { label: 'Anti-D Ig', effect: {}, category: 'Drugs', log: 'Anti-D Immunoglobulin administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Prostin': { label: 'Dinoprostone (Prostin)', effect: {}, category: 'Drugs', log: 'IV Dinoprostone infusion started.', type: 'continuous', duration: 0, requires: ['IV Access'] },

    // --- CARDIAC & MEDICAL ---
    'Labetalol': { label: 'Labetalol', effect: { BP: -20, HR: -10 }, category: 'Drugs', log: 'IV Labetalol administered.', type: 'bolus', duration: 15, requires: ['IV Access'] },
    'Phentolamine': { label: 'Phentolamine', effect: { BP: -20 }, category: 'Drugs', log: 'IV Phentolamine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Digibind': { label: 'Digibind', effect: { HR: 10 }, category: 'Drugs', log: 'Digoxin-specific antibody fragments administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'SodiumBicarb': { label: 'Sodium Bicarbonate', effect: { pH: 0.1 }, category: 'Drugs', log: 'IV Sodium Bicarbonate administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'HypertonicSaline': { label: 'Hypertonic Saline', effect: { BP: 5, gcs: 1 }, category: 'Drugs', log: 'Hypertonic Saline (3%) administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'T3T4': { label: 'Liothyronine (T3)', effect: { HR: 5, Temp: 0.5 }, category: 'Drugs', log: 'IV Liothyronine administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Bisphosphonate': { label: 'Bisphosphonate', effect: {}, category: 'Drugs', log: 'IV Bisphosphonate administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'IVIG': { label: 'IVIG', effect: {}, category: 'Drugs', log: 'Intravenous Immunoglobulin administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'Chlorphenamine': { label: 'Chlorphenamine', effect: {}, category: 'Drugs', log: 'IV Chlorphenamine administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },

    // --- TOXICOLOGY & MISC ---
    'Lipid': { label: 'Intralipid 20%', effect: {}, category: 'Drugs', log: 'Intralipid 20% emulsion administered.', type: 'bolus', duration: 60, requires: ['IV Access'] },
    'Desferrioxamine': { label: 'Desferrioxamine', effect: {}, category: 'Drugs', log: 'IV Desferrioxamine infusion started.', type: 'continuous', duration: 0, requires: ['IV Access'] },
    'Fomepizole': { label: 'Fomepizole', effect: {}, category: 'Drugs', log: 'IV Fomepizole administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Dantrolene': { label: 'Dantrolene', effect: { Temp: -1 }, category: 'Drugs', log: 'IV Dantrolene administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Pralidoxime': { label: 'Pralidoxime', effect: {}, category: 'Drugs', log: 'IV Pralidoxime administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'Charcoal': { label: 'Activated Charcoal', effect: {}, category: 'Drugs', log: 'Activated Charcoal administered.', type: 'bolus', duration: 10 },
    'Lactulose': { label: 'Lactulose', effect: {}, category: 'Drugs', log: 'Lactulose administered.', type: 'bolus', duration: 10 },
    'Rifaximin': { label: 'Rifaximin', effect: {}, category: 'Drugs', log: 'Rifaximin administered.', type: 'bolus', duration: 10 },
    'Terlipressin': { label: 'Terlipressin', effect: { BP: 10 }, category: 'Drugs', log: 'IV Terlipressin administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Octaplex': { label: 'Octaplex / PCC', effect: {}, category: 'Drugs', log: 'Prothrombin Complex Concentrate administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'VitaminK': { label: 'Vitamin K', effect: {}, category: 'Drugs', log: 'IV Vitamin K administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Rasburicase': { label: 'Rasburicase', effect: {}, category: 'Drugs', log: 'IV Rasburicase administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'VitaminA': { label: 'Vitamin A', effect: {}, category: 'Drugs', log: 'Vitamin A administered.', type: 'bolus', duration: 10 },
    'Acetazolamide': { label: 'Acetazolamide', effect: {}, category: 'Drugs', log: 'IV Acetazolamide administered.', type: 'bolus', duration: 10, requires: ['IV Access'] },
    'Cyproheptadine': { label: 'Cyproheptadine', effect: {}, category: 'Drugs', log: 'Cyproheptadine administered.', type: 'bolus', duration: 10 },
    'Antivenom': { label: 'Antivenom', effect: {}, category: 'Drugs', log: 'Antivenom administered.', type: 'bolus', duration: 30, requires: ['IV Access'] },
    'ExchangeTransfusion': { label: 'Exchange Transfusion', effect: {}, category: 'Procedures', log: 'Exchange Transfusion started.', type: 'continuous', duration: 300, requires: ['IV Access'] },

    // --- ADDITIONAL PROCEDURES ---
    'NerveBlock': { label: 'Nerve Block (FIB)', effect: { HR: -5 }, category: 'Procedures', log: 'Fascia Iliaca Block performed.', type: 'bolus', duration: 120 },
    'Canthotomy': { label: 'Lat. Canthotomy', effect: {}, category: 'Procedures', log: 'Lateral Canthotomy performed.', type: 'bolus', duration: 60 },
    'Escharotomy': { label: 'Escharotomy', effect: {}, category: 'Procedures', log: 'Escharotomy performed.', type: 'bolus', duration: 120 },
    'AirEnema': { label: 'Air Enema', effect: {}, category: 'Procedures', log: 'Radiological air enema performed.', type: 'bolus', duration: 120 },
    'Pericardiocentesis': { label: 'Pericardiocentesis', effect: { BP: 20, HR: -10 }, category: 'Procedures', log: 'Needle pericardiocentesis performed.', type: 'bolus', duration: 60 },
    'Tourniquet': { label: 'Tourniquet', effect: {}, category: 'Procedures', log: 'Tourniquet applied.', type: 'continuous', duration: 10 },
    'TopicalEyeDrops': { label: 'Topical Eye Drops', effect: {}, category: 'Drugs', log: 'Topical eye drops (Timolol/Pilocarpine) applied.', type: 'bolus', duration: 10 },
    'Plaster': { label: 'Plaster / Backslab', effect: {}, category: 'Procedures', log: 'Plaster backslab applied.', type: 'continuous', duration: 120 },
    'ClingFilm': { label: 'Cling Film', effect: { Temp: 0.5 }, category: 'Procedures', log: 'Burns covered with cling film.', type: 'continuous', duration: 30 },
};

// ==========================================
// PART 3: SCENARIOS
// ==========================================
window.RAW_SCENARIOS = [
  { id: 'AM001', title: 'Acute STEMI', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(45, 75), patientProfileTemplate: "A {age}-year-old {sex}. Crushing chest pain > 1 hr.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Classic STEMI. Risk of VF.", interventions: ["PPCI", "Aspirin", "Ticagrelor/Clopidogrel", "Heparin"], learningObjectives: ["Identify STEMI", "Manage ACS"] }, vitalsMod: { hr: 95, bpSys: 145, spO2: 96 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, ecg: { type: "STEMI", findings: "Anterior ST Elevation" }, recommendedActions: ['Obs', 'IV Access', 'Aspirin', 'Clopidogrel', 'GTN', 'Analgesia', 'Oxygen'] },
      { id: 'AM002', title: 'Severe Sepsis (Pneumonia)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(60, 90), patientProfileTemplate: "A {age}-year-old. Productive cough, confusion, fever.", presentingComplaint: 'Confusion & Fever', instructorBrief: { progression: "Septic shock. Needs Sepsis 6.", interventions: ["Oxygen", "Fluids", "Antibiotics"], learningObjectives: ["Sepsis 6", "Fluid Resus"] }, vitalsMod: { hr: 125, bpSys: 85, spO2: 88, temp: 39.2 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, ecg: { type: "Sinus Tachy", findings: "Sinus Tachycardia" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Fluids', 'Antibiotics'] },
      { id: 'AM003', title: 'Acute Severe Asthma', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 40), patientProfileTemplate: "A {age}-year-old asthmatic. Short of breath.", presentingComplaint: 'Dyspnoea', instructorBrief: { progression: "Life threatening. Silent chest.", interventions: ["Nebs", "Magnesium", "Steroids"], learningObjectives: ["Asthma Management"] }, vitalsMod: { hr: 130, bpSys: 110, spO2: 88, rr: 35 }, deterioration: { active: true, rate: 0.08, type: 'respiratory' }, stabilisers: ['Nebs', 'Magnesium'], ecg: { type: "Sinus Tachy", findings: "Sinus Tachycardia" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Nebs', 'Dexamethasone', 'MagSulph'] },
      { id: 'AM004', title: 'Hyperkalaemia (Renal)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 80), patientProfileTemplate: "A {age}-year-old dialysis patient. Missed dialysis.", presentingComplaint: 'Weakness', instructorBrief: { progression: "Broad complex bradycardia. Risk of arrest.", interventions: ["Calcium Gluconate", "Insulin/Dextrose"], learningObjectives: ["Hyperkalaemia treatment"] }, vitalsMod: { hr: 40, bpSys: 90, spO2: 95 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, ecg: { type: "Sinus Rhythm", findings: "Broad complex, Tented T waves" }, vbgClinicalState: "hyperkalemia", recommendedActions: ['Obs', 'IV Access', 'Calcium', 'InsulinDextrose', 'Nebs'] },
      { id: 'AM011', title: 'Acute Pulmonary Oedema', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(65, 85), patientProfileTemplate: "A {age}-year-old with heart failure history. Sudden onset severe breathlessness.", presentingComplaint: 'Severe Dyspnoea', instructorBrief: { progression: "Flash pulmonary oedema. Severe respiratory distress.", interventions: ["GTN (SL/IV)", "Furosemide", "CPAP"], learningObjectives: ["Manage acute heart failure", "CPAP Indications"] }, vitalsMod: { hr: 110, bpSys: 180, spO2: 85, rr: 32 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['GTN', 'GTNInfusion', 'CPAP', 'Furosemide'], ecg: { type: "Sinus Tachy", findings: "Sinus Tachy, LVH" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'CPAP', 'GTN', 'Furosemide'] },
      { id: 'AM012', title: 'COPD Exacerbation (Infective)', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(55, 80), patientProfileTemplate: "A {age}-year-old smoker. 3 days productive cough and increasing wheeze.", presentingComplaint: 'Wheeze & DIB', instructorBrief: { progression: "Type 2 Respiratory Failure. CO2 retainer.", interventions: ["Nebs (Air)", "Steroids", "Antibiotics", "Consider NIV"], learningObjectives: ["Oxygen targets in COPD", "NIV indications"] }, vitalsMod: { hr: 100, bpSys: 130, spO2: 84, rr: 28 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Nebs', 'Dexamethasone', 'NIV'], vbgClinicalState: "copd_retainer", recommendedActions: ['Obs', 'IV Access', 'Nebs', 'Dexamethasone', 'Antibiotics', 'NIV'] },
      { id: 'AM013', title: 'Diabetic Ketoacidosis (DKA)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 35), patientProfileTemplate: "A {age}-year-old Type 1 Diabetic. Vomiting and abdo pain for 24hrs.", presentingComplaint: 'Vomiting & Abdo Pain', instructorBrief: { progression: "Severe metabolic acidosis. Dehydration.", interventions: ["Fluids (0.9% Saline)", "Fixed Rate Insulin", "Potassium Replacement"], learningObjectives: ["DKA Protocol", "Fluid management"] }, vitalsMod: { hr: 115, bpSys: 100, spO2: 97, rr: 28, bm: 26 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Fluids'], vbgClinicalState: "dka_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'InsulinDextrose'] },
      { id: 'AM014', title: 'HHS', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(60, 85), patientProfileTemplate: "A {age}-year-old Type 2 Diabetic. Confused and lethargic over 1 week.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Severe dehydration and hyperosmolality.", interventions: ["Aggressive Fluids", "Conservative Insulin", "LMWH"], learningObjectives: ["HHS vs DKA", "Osmolality"] }, vitalsMod: { hr: 110, bpSys: 95, spO2: 94, rr: 20, gcs: 12, bm: 48 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Fluids'], vbgClinicalState: "hhs", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'InsulinDextrose', 'Heparin'] },
      { id: 'AM015', title: 'Massive Pulmonary Embolism', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 65), patientProfileTemplate: "A {age}-year-old. Recent long haul flight. Sudden collapse and chest pain.", presentingComplaint: 'Collapse & SOB', instructorBrief: { progression: "Obstructive shock. Peri-arrest.", interventions: ["Thrombolysis", "Oxygen", "Fluid (Cautious)"], learningObjectives: ["Massive PE recognition", "Thrombolysis indications"] }, vitalsMod: { hr: 135, bpSys: 80, spO2: 82, rr: 30 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Oxygen'], ecg: { type: "Sinus Tachy", findings: "Sinus Tachy, S1Q3T3, RBBB" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Fluids', 'Thrombolysis'] },
      { id: 'AM016', title: 'Upper GI Bleed (Variceal)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(40, 65), patientProfileTemplate: "A {age}-year-old with chronic liver disease. Vomiting large amounts of fresh blood.", presentingComplaint: 'Haematemesis', instructorBrief: { progression: "Haemorrhagic shock. Airway risk.", interventions: ["Blood Protocol", "Terlipressin", "Antibiotics", "Intubation"], learningObjectives: ["Major Haemorrhage Protocol", "Variceal bleed management"] }, vitalsMod: { hr: 125, bpSys: 85, spO2: 95, rr: 22 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Blood', 'TXA'], vbgClinicalState: "gi_bleed", recommendedActions: ['Obs', 'IV Access', 'Blood', 'TXA', 'Antibiotics', 'Terlipressin', 'RSI'] },
      { id: 'AM017', title: 'Bacterial Meningitis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 30), patientProfileTemplate: "A {age}-year-old student. Severe headache, photophobia, and non-blanching rash.", presentingComplaint: 'Headache & Rash', instructorBrief: { progression: "Septic shock and raised ICP.", interventions: ["IV Ceftriaxone", "Dexamethasone", "Fluids"], learningObjectives: ["Meningitis recognition", "Lumbar Puncture contraindications"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 98, temp: 39.5, gcs: 13 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Antibiotics', 'Dexamethasone', 'Fluids'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Antibiotics', 'Dexamethasone', 'Fluids'] },
      { id: 'AM018', title: 'Addisonian Crisis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Known Addison's. Vomiting for 2 days. Stopped steroids.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Distributive shock. Hypoglycaemia risk.", interventions: ["IV Hydrocortisone", "Fluids (Saline)", "Dextrose"], learningObjectives: ["Adrenal crisis management", "Steroid sick days"] }, vitalsMod: { hr: 115, bpSys: 80, spO2: 96, bm: 3.2 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Fluids'], vbgClinicalState: "hyponatremia", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Hydrocortisone', 'InsulinDextrose'] },
      { id: 'AM019', title: 'Thyrotoxic Storm', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Agitated, sweating profusely, palpitations.", presentingComplaint: 'Palpitations & Confusion', instructorBrief: { progression: "High output cardiac failure. Hyperthermia.", interventions: ["Beta-blockers", "Fluids", "Cooling", "Carbimazole"], learningObjectives: ["Thyroid storm recognition", "Burch-Wartofsky score"] }, vitalsMod: { hr: 150, bpSys: 160, spO2: 96, temp: 39.8 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, ecg: { type: "AF", findings: "Fast AF" }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Labetalol', 'Hydrocortisone', 'Cooling'] },
      { id: 'AM020', title: 'Subarachnoid Haemorrhage', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(40, 60), patientProfileTemplate: "A {age}-year-old. Sudden onset occipital headache 'like being hit with a bat'.", presentingComplaint: 'Thunderclap Headache', instructorBrief: { progression: "Risk of re-bleed and hydrocephalus. Cushing's response.", interventions: ["CT Head", "Nimodipine", "BP Control", "Neuro Obs"], learningObjectives: ["SAH presentation", "Cushing's Triad"] }, vitalsMod: { hr: 55, bpSys: 170, spO2: 98, gcs: 14 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Analgesia'], recommendedActions: ['Obs', 'IV Access', 'Analgesia', 'Labetalol', 'Nimodipine'] },
      { id: 'AM021', title: 'Acute Ischaemic Stroke', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(55, 80), patientProfileTemplate: "A {age}-year-old. Sudden onset right sided weakness and slurred speech 1 hour ago.", presentingComplaint: 'Stroke Symptoms', instructorBrief: { progression: "Time critical. Thrombolysis candidate.", interventions: ["CT Head", "Thrombolysis (if bleed excluded)", "BP Control"], learningObjectives: ["FAST positive", "Thrombolysis window"] }, vitalsMod: { hr: 80, bpSys: 165, spO2: 96, gcs: 13 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, recommendedActions: ['Obs', 'IV Access', 'Aspirin'] },
      { id: 'AM022', title: 'Status Epilepticus (Adult)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Seizing for 15 minutes.", presentingComplaint: 'Seizure', instructorBrief: { progression: "Exhaustion and hypoxia. Refractory status.", interventions: ["Benzodiazepines (Lorazepam)", "Phenytoin/Levetiracetam", "RSI"], learningObjectives: ["Status epilepticus algorithm"] }, vitalsMod: { hr: 130, bpSys: 140, spO2: 88, rr: 10, gcs: 3 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Lorazepam', 'RSI', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Lorazepam', 'RSI'] },
      { id: 'AM023', title: 'Complete Heart Block', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(60, 90), patientProfileTemplate: "A {age}-year-old. Collapsed. Feeling dizzy.", presentingComplaint: 'Syncope', instructorBrief: { progression: "Unstable bradycardia. Risk of asystole.", interventions: ["Atropine (Likely ineffective)", "Pacing (External)", "Isoprenaline"], learningObjectives: ["Bradycardia algorithm", "Pacing indications"] }, vitalsMod: { hr: 32, bpSys: 75, spO2: 94 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Pacing', 'Metaraminol'], ecg: { type: "Sinus Rhythm", findings: "3rd Degree AV Block (Dissociation)" }, recommendedActions: ['Obs', 'IV Access', 'Atropine', 'Pacing', 'Metaraminol'] },
      { id: 'AM024', title: 'VT with Pulse', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 75), patientProfileTemplate: "A {age}-year-old. Palpitations and chest tightness.", presentingComplaint: 'Palpitations', instructorBrief: { progression: "Unstable broad complex tachycardia.", interventions: ["Synchronised Cardioversion", "Amiodarone"], learningObjectives: ["Tachycardia algorithm", "Safe cardioversion"] }, vitalsMod: { hr: 170, bpSys: 90, spO2: 95 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Amiodarone', 'Cardioversion'], ecg: { type: "VT", findings: "Monomorphic VT" }, recommendedActions: ['Obs', 'IV Access', 'Amiodarone', 'Cardioversion'] },
      { id: 'AM025', title: 'SVT (Adult)', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Sudden onset racing heart.", presentingComplaint: 'Palpitations', instructorBrief: { progression: "Narrow complex tachycardia.", interventions: ["Vagal Manoeuvres", "Adenosine"], learningObjectives: ["Adenosine administration", "ECG recognition"] }, vitalsMod: { hr: 190, bpSys: 110, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Adenosine'], ecg: { type: "SVT", findings: "SVT" }, recommendedActions: ['Obs', 'IV Access', 'Manoeuvres', 'Adenosine'] },
      { id: 'AM026', title: 'Anaphylaxis (Adult)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Bee sting. Swollen face and difficulty breathing.", presentingComplaint: 'Anaphylaxis', instructorBrief: { progression: "Airway swelling and shock.", interventions: ["IM Adrenaline", "Fluids", "Nebs"], learningObjectives: ["Anaphylaxis algorithm"] }, vitalsMod: { hr: 130, bpSys: 80, spO2: 90, rr: 30 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Adrenaline', 'Fluids', 'Nebs'], recommendedActions: ['Obs', 'IV Access', 'Adrenaline', 'Fluids', 'Nebs', 'Hydrocortisone', 'Chlorphenamine'] },
      { id: 'AM027', title: 'Aortic Dissection (Type A)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 75), patientProfileTemplate: "A {age}-year-old. Tearing chest pain radiating to back.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Hypertensive emergency. Risk of rupture.", interventions: ["BP Control (Labetalol)", "Analgesia", "CT Aorta"], learningObjectives: ["Dissection recognition", "BP targets"] }, vitalsMod: { hr: 100, bpSys: 190, spO2: 98 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Labetalol', 'Analgesia'], ecg: { type: "Sinus Rhythm", findings: "NSR" }, recommendedActions: ['Obs', 'IV Access', 'Labetalol', 'Analgesia', 'Surgery'] },
      { id: 'AM028', title: 'Severe Hyponatremia', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(60, 85), patientProfileTemplate: "A {age}-year-old. Confused and vomiting. On diuretics.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Cerebral oedema and seizures.", interventions: ["Hypertonic Saline (if seizing)", "Fluid Restriction"], learningObjectives: ["Hyponatremia correction", "Seizure management"] }, vitalsMod: { hr: 90, bpSys: 130, spO2: 96, gcs: 11 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, vbgClinicalState: "hyponatremia", recommendedActions: ['Obs', 'IV Access', 'HypertonicSaline'] },
      { id: 'AM029', title: 'Ascending Cholangitis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 80), patientProfileTemplate: "A {age}-year-old. RUQ pain, fever, and rigors.", presentingComplaint: 'Abdo Pain & Fever', instructorBrief: { progression: "Biliary sepsis (Charcot's Triad).", interventions: ["Antibiotics", "Fluids", "Surgical/ERCP referral"], learningObjectives: ["Sepsis Source", "Charcot's Triad"] }, vitalsMod: { hr: 120, bpSys: 95, spO2: 95, temp: 39.0 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Antibiotics', 'Fluids'], vbgClinicalState: "septic_shock", recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'Analgesia', 'Surgery'] },
      { id: 'AM030', title: 'Community Acquired Pneumonia', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(30, 70), patientProfileTemplate: "A {age}-year-old. 1 week cough, now breathless.", presentingComplaint: 'Cough & DIB', instructorBrief: { progression: "Type 1 Respiratory failure.", interventions: ["Oxygen", "Antibiotics", "Fluids"], learningObjectives: ["CURB-65", "Oxygen therapy"] }, vitalsMod: { hr: 110, bpSys: 115, spO2: 88, rr: 28, temp: 38.5 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Antibiotics', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Oxygen', 'Fluids'] },
      { id: 'AM031', title: 'Tension Pneumothorax', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Sudden onset pleuritic pain and severe breathlessness. History of Marfan's.", presentingComplaint: 'Severe Dyspnoea', instructorBrief: { progression: "Obstructive shock. Tracheal deviation.", interventions: ["Needle Decompression", "Chest Drain"], learningObjectives: ["Needle Thoracocentesis location", "Obstructive Shock signs"] }, vitalsMod: { hr: 135, bpSys: 75, spO2: 82, rr: 38 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Needle', 'SeldingerDrain', 'FingerThoracostomy'], ecg: { type: "Sinus Tachy", findings: "Sinus Tachycardia" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Needle', 'FingerThoracostomy', 'SurgicalDrain'] },
      { id: 'AM032', title: 'Myxoedema Coma', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(60, 85), patientProfileTemplate: "A {age}-year-old female. Found confused and cold. History of hypothyroidism.", presentingComplaint: 'Confusion & Hypothermia', instructorBrief: { progression: "Profound bradycardia and hypothermia.", interventions: ["T3/T4 (Liothyronine)", "Steroids", "Passive Warming"], learningObjectives: ["Myxoedema recognition", "Warming caution"] }, vitalsMod: { hr: 38, bpSys: 85, spO2: 92, temp: 34.2, gcs: 10 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, stabilisers: ['T3T4', 'Hydrocortisone', 'Warming'], ecg: { type: "Sinus Brady", findings: "Sinus Brady, Low Voltage" }, recommendedActions: ['Obs', 'IV Access', 'T3T4', 'Hydrocortisone', 'Warming'] },
      { id: 'AM033', title: 'Severe Hypercalcaemia', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(50, 80), patientProfileTemplate: "A {age}-year-old. 'Bones, stones, groans'. Profound dehydration and confusion.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Renal failure and arrhythmia risk.", interventions: ["Aggressive Fluids", "Bisphosphonates"], learningObjectives: ["Hypercalcaemia management", "Fluid targets"] }, vitalsMod: { hr: 95, bpSys: 100, spO2: 96, gcs: 13 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Fluids', 'Bisphosphonate'], vbgClinicalState: "hypercalcemia", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Bisphosphonate'] },
      { id: 'AM034', title: 'Boerhaave\'s Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(40, 60), patientProfileTemplate: "A {age}-year-old. Severe vomiting after alcohol binge, then sudden tearing chest pain.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Mackler's Triad. Sepsis/Mediastinitis.", interventions: ["Antibiotics", "Fluids", "Surgical Referral"], learningObjectives: ["Oesophageal rupture signs", "Mackler's Triad"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 94, rr: 28 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Antibiotics', 'Fluids', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'Surgery', 'Analgesia'] },
      { id: 'AM035', title: 'CO Poisoning', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 80), patientProfileTemplate: "A {age}-year-old. Found in garage with car running. Headache and nausea.", presentingComplaint: 'Headache', instructorBrief: { progression: "False SpO2 reading. Neuro toxicity.", interventions: ["High Flow Oxygen", "Hyperbaric Referral?"], learningObjectives: ["CO half-life", "SpO2 limitations"] }, vitalsMod: { hr: 105, bpSys: 130, spO2: 100, rr: 20, gcs: 14 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Oxygen'], vbgClinicalState: "co_poisoning", recommendedActions: ['Obs', 'IV Access', 'Oxygen'] },
      { id: 'AM036', title: 'Serotonin Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Started new antidepressant. Agitated, hyperthermic, clonus.", presentingComplaint: 'Agitation', instructorBrief: { progression: "Hyperthermia and rhabdomyolysis.", interventions: ["Benzodiazepines", "Cooling", "Cyproheptadine"], learningObjectives: ["Serotonin toxicity criteria", "Cooling methods"] }, vitalsMod: { hr: 140, bpSys: 160, spO2: 96, temp: 39.5, gcs: 13 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Midazolam', 'Lorazepam', 'Warming'], recommendedActions: ['Obs', 'IV Access', 'Lorazepam', 'Midazolam', 'Cooling', 'Fluids', 'Cyproheptadine'] },
      { id: 'AM037', title: 'Cholinergic Crisis', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old farmer. Found collapsed near pesticides. SLUDGE symptoms.", presentingComplaint: 'Collapse & Salivation', instructorBrief: { progression: "Bradycardia, Bronchorrhoea. Organophosphate poisoning.", interventions: ["Atropine (High Dose)", "Pralidoxime"], learningObjectives: ["SLUDGE mnemonic", "Atropine dosing"] }, vitalsMod: { hr: 45, bpSys: 90, spO2: 88, rr: 28, pupils: "Pinpoint" }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['Atropine'], recommendedActions: ['Obs', 'IV Access', 'Atropine', 'Suction', 'Oxygen', 'Pralidoxime'] },
      { id: 'AM038', title: 'Guillain-Barr Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(30, 70), patientProfileTemplate: "A {age}-year-old. 2 weeks post viral illness. Ascending weakness/paraesthesia.", presentingComplaint: 'Weakness', instructorBrief: { progression: "Respiratory failure due to diaphragm weakness.", interventions: ["FVC Monitoring", "Intubation (Early)"], learningObjectives: ["GBS recognition", "Respiratory monitoring"] }, vitalsMod: { hr: 80, bpSys: 130, spO2: 95, rr: 14 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, recommendedActions: ['Obs', 'IV Access', 'RSI'] },
      { id: 'AM005', title: 'Tricyclic Overdose', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Found with empty Amitriptyline packet.", presentingComplaint: 'Overdose', instructorBrief: { progression: "Anticholinergic toxidrome. Na channel blockade.", interventions: ["Sodium Bicarbonate", "Intubation"], learningObjectives: ["TCA Toxicity", "ECG changes"] }, vitalsMod: { hr: 130, bpSys: 90, spO2: 96, gcs: 10 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, ecg: { type: "Sinus Tachy", findings: "Wide QRS, Dominant R in aVR" }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'RSI', 'SodiumBicarb'] },
      { id: 'AM006', title: 'Opioid Overdose', category: 'Toxicology', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Found unresponsive. Pinpoint pupils.", presentingComplaint: 'Unresponsive', instructorBrief: { progression: "Respiratory depression.", interventions: ["Naloxone", "Ventilatory Support"], learningObjectives: ["Opioid Toxidrome", "Naloxone dosing"] }, vitalsMod: { hr: 60, bpSys: 100, spO2: 85, rr: 4, gcs: 6 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Naloxone', 'Bagging'], ecg: { type: "Sinus Rhythm", findings: "NSR" }, recommendedActions: ['Obs', 'IV Access', 'Naloxone', 'Bagging', 'Oxygen'] },
      { id: 'AM007', title: 'Paracetamol Overdose', category: 'Toxicology', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(18, 40), patientProfileTemplate: "A {age}-year-old. Took 30g Paracetamol 4 hours ago.", presentingComplaint: 'Overdose', instructorBrief: { progression: "Asymptomatic phase but high risk.", interventions: ["NAC", "Blood Levels"], learningObjectives: ["Paracetamol nomogram", "NAC indications"] }, vitalsMod: { hr: 80, bpSys: 120, spO2: 98, gcs: 15 }, deterioration: { active: false, rate: 0 }, ecg: { type: "Sinus Rhythm", findings: "NSR" }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Pabrinex'] },
      { id: 'AM008', title: 'Acute Alcohol Withdrawal', category: 'Psychiatric', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old alcoholic. Stopped drinking 2 days ago.", presentingComplaint: 'Tremors & Hallucinations', instructorBrief: { progression: "Delirium Tremens. Seizure risk.", interventions: ["Benzodiazepines", "Pabrinex"], learningObjectives: ["CIWA scoring", "Safe sedation"] }, vitalsMod: { hr: 130, bpSys: 160, spO2: 96, temp: 38.0 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, ecg: { type: "Sinus Tachy", findings: "Sinus Tachycardia" }, recommendedActions: ['Obs', 'IV Access', 'Lorazepam', 'Pabrinex', 'Fluids'] },
      { id: 'AM009', title: 'Psychiatric Emergency (Manic)', category: 'Psychiatric', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Aggressive, flight of ideas.", presentingComplaint: 'Aggression', instructorBrief: { progression: "Risk of violence. Rapid Tranquillisation required.", interventions: ["De-escalation", "Lorazepam/Haloperidol"], learningObjectives: ["Rapid Tranq guidelines", "Mental Capacity Act"] }, vitalsMod: { hr: 110, bpSys: 140, spO2: 99 }, deterioration: { active: false, rate: 0 }, ecg: { type: "Sinus Tachy", findings: "NSR" }, recommendedActions: ['Obs', 'IV Access', 'Lorazepam', 'Midazolam'] },
      { id: 'AT001', title: 'Major Trauma (RTC)', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old driver. High speed RTC. Trapped 30 mins.", presentingComplaint: 'Polytrauma', instructorBrief: { progression: "Haemorrhagic shock. Pelvic/Chest injuries.", interventions: ["Binder", "TXA", "Blood"], learningObjectives: ["Major Trauma Call", "Permissive Hypotension"] }, vitalsMod: { hr: 130, bpSys: 80, spO2: 92, rr: 30, gcs: 13 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Blood', 'Binder'], vbgClinicalState: "haemorrhagic_shock", recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Blood', 'TXA', 'Binder', 'Splinting'] },
      { id: 'AT002', title: 'Stab Wound Chest', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 35), patientProfileTemplate: "A {age}-year-old male. Stabbed in right chest.", presentingComplaint: 'Stab Wound', instructorBrief: { progression: "Tension Pneumothorax.", interventions: ["Decompression", "Drain"], learningObjectives: ["Chest decompression"] }, vitalsMod: { hr: 140, bpSys: 70, spO2: 80, rr: 40 }, deterioration: { active: true, rate: 0.2, type: 'arrest' }, stabilisers: ['Needle', 'FingerThoracostomy', 'SurgicalDrain'], chestXray: { findings: "Tension Pneumothorax" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Needle', 'FingerThoracostomy', 'SurgicalDrain', 'Blood'] },
      { id: 'AT003', title: 'Isolated Head Injury', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 60), patientProfileTemplate: "A {age}-year-old. Fell down stairs. GCS dropped.", presentingComplaint: 'Head Injury', instructorBrief: { progression: "Extradural haematoma. Cushing's response.", interventions: ["RSI", "Neuroprotective measures", "CT Head"], learningObjectives: ["Raised ICP management", "Cushing's Triad"] }, vitalsMod: { hr: 50, bpSys: 180, spO2: 96, gcs: 8, pupils: 'Fixed/Dilated R' }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, ecg: { type: "Sinus Brady", findings: "Sinus Bradycardia" }, recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'RSI', 'TXA', 'Collar'] },
      { id: 'AT004', title: 'Burns (Thermal)', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. House fire. 40% TBSA burns.", presentingComplaint: 'Burns', instructorBrief: { progression: "Airway oedema risk. Fluid loss.", interventions: ["Intubation (Early)", "Parkland Fluid"], learningObjectives: ["Burn airway assessment", "Fluid calculation"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 90, rr: 28, gcs: 15 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Fluids', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'RSI', 'Analgesia', 'Warming', 'Escharotomy'] },
      { id: 'AT005', title: 'Neurogenic Shock', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Rugby tackle injury. Can't move legs. Priapism.", presentingComplaint: 'Paralysis', instructorBrief: { progression: "Hypotension with Bradycardia (autonomic mismatch).", interventions: ["Vasopressors", "Spinal Immobilisation", "Fluids"], learningObjectives: ["Neurogenic vs Spinal shock", "Vasopressor choice"] }, vitalsMod: { hr: 48, bpSys: 75, spO2: 96, gcs: 15, temp: 35.8 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Metaraminol', 'AdrenalineIV', 'Fluids'], ecg: { type: "Sinus Brady", findings: "Sinus Bradycardia" }, recommendedActions: ['Obs', 'IV Access', 'Metaraminol', 'Fluids', 'Collar', 'Splinting'] },
      { id: 'AT006', title: 'Flail Chest', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Kicked by horse. Paradoxical chest wall movement.", presentingComplaint: 'Chest Pain & DIB', instructorBrief: { progression: "Respiratory failure due to pain/mechanics.", interventions: ["Analgesia (Blocks)", "Oxygen", "NIV?"], learningObjectives: ["Flail chest mechanics", "Pain management importance"] }, vitalsMod: { hr: 110, bpSys: 120, spO2: 91, rr: 28 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Analgesia', 'Fentanyl', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Analgesia', 'Fentanyl', 'NerveBlock'] },
      { id: 'AT007', title: 'Penetrating Neck Injury', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 40), patientProfileTemplate: "A {age}-year-old. Stabbed in Zone 2 of neck. Expanding haematoma.", presentingComplaint: 'Stab Wound', instructorBrief: { progression: "Airway compromise. Hard signs of vascular injury.", interventions: ["Early Intubation", "Direct Pressure", "Surgery"], learningObjectives: ["Neck trauma zones", "Hard vs Soft signs"] }, vitalsMod: { hr: 125, bpSys: 95, spO2: 96, rr: 24, gcs: 14 }, deterioration: { active: true, rate: 0.1, type: 'airway' }, stabilisers: ['RSI', 'Surgery', 'Blood'], recommendedActions: ['Obs', 'IV Access', 'RSI', 'Blood', 'Surgery', 'FONA'] },
      { id: 'AT008', title: 'Crush Syndrome', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(25, 55), patientProfileTemplate: "A {age}-year-old worker. Legs trapped under concrete slab for 4 hours.", presentingComplaint: 'Trapped Limb', instructorBrief: { progression: "Reperfusion injury. Hyperkalaemia upon release.", interventions: ["Fluid Loading (Pre-release)", "Calcium/Insulin", "Bicarb"], learningObjectives: ["Crush syndrome physiology", "Hyperkalaemia management"] }, vitalsMod: { hr: 110, bpSys: 100, spO2: 98 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Fluids', 'Calcium', 'InsulinDextrose'], ecg: { type: "Sinus Rhythm", findings: "Peaked T Waves" }, vbgClinicalState: "hyperkalemia", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Calcium', 'InsulinDextrose', 'SodiumBicarb'] },
      { id: 'EL001', title: 'NOF Fracture', category: 'Trauma', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(75, 95), patientProfileTemplate: "A {age}-year-old. Fall from standing. Shortened/Rotated leg.", presentingComplaint: 'Hip Pain', instructorBrief: { progression: "Pain management critical. Check for medical cause of fall.", interventions: ["Fascia Iliaca Block", "Analgesia"], learningObjectives: ["NOF management", "Frailty assessment"] }, vitalsMod: { hr: 90, bpSys: 150, spO2: 95 }, deterioration: { active: false, rate: 0 }, ecg: { type: "Sinus Rhythm", findings: "NSR or AF" }, recommendedActions: ['Obs', 'IV Access', 'Analgesia', 'Fentanyl', 'NerveBlock'] },
      { id: 'EL002', title: 'Elderly Sepsis (UTI)', category: 'Medical', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(80, 99), patientProfileTemplate: "A {age}-year-old. Confusion and off legs.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Urosepsis. Subtle presentation.", interventions: ["Antibiotics", "Fluids (Caution)"], learningObjectives: ["Sepsis in elderly", "Delirium"] }, vitalsMod: { hr: 105, bpSys: 100, spO2: 93, temp: 35.8, gcs: 13 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, vbgClinicalState: "septic_shock", recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'Oxygen'] },
      { id: 'EL003', title: 'Subdural Haemorrhage', category: 'Trauma', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "A {age}-year-old. Minor head bump 2 weeks ago. Now confused.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Chronic Subdural. Slow deterioration.", interventions: ["CT Head", "Reverse Anticoagulation"], learningObjectives: ["Head injury in elderly", "Anticoagulation reversal"] }, vitalsMod: { hr: 70, bpSys: 130, spO2: 96, gcs: 12 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, recommendedActions: ['Obs', 'IV Access', 'VitaminK', 'Octaplex'] },
      { id: 'EL004', title: 'Ruptured AAA', category: 'Medical', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(70, 90), patientProfileTemplate: "A {age}-year-old. Sudden onset severe back pain and collapse.", presentingComplaint: 'Back Pain & Syncope', instructorBrief: { progression: "Catastrophic haemorrhage.", interventions: ["Permissive Hypotension", "Massive Transfusion", "Immediate Theatre"], learningObjectives: ["AAA presentation", "Hypotension targets"] }, vitalsMod: { hr: 110, bpSys: 80, spO2: 94, rr: 24, gcs: 14 }, deterioration: { active: true, rate: 0.2, type: 'shock' }, stabilisers: ['Blood', 'Surgery'], vbgClinicalState: "haemorrhagic_shock", recommendedActions: ['Obs', 'IV Access', 'Blood', 'Surgery', 'Analgesia', 'TXA'] },
      { id: 'EL005', title: 'Severe Hypothermia', category: 'Medical', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 95), patientProfileTemplate: "A {age}-year-old. Found on floor after 12 hours. Cold to touch.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Risk of VF with handling. Coagulopathy.", interventions: ["Passive/Active Warming", "Gentle Handling"], learningObjectives: ["Swiss staging", "Resus modification"] }, vitalsMod: { hr: 40, bpSys: 85, spO2: 90, temp: 29.5, gcs: 9 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, stabilisers: ['Warming'], ecg: { type: "Sinus Brady", findings: "Osborn J Waves" }, vbgClinicalState: "hypothermia", recommendedActions: ['Obs', 'IV Access', 'Warming', 'Fluids'] },
      { id: 'PA001', title: 'Meningococcal Sepsis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 5), patientProfileTemplate: "A {age}-year-old. High fever, purpuric rash.", presentingComplaint: 'Fever & Rash', instructorBrief: { progression: "Septic shock. Rapid decline.", interventions: ["IM/IV Ceftriaxone", "Fluids", "IO Access"], learningObjectives: ["Paeds Sepsis", "IO Access"] }, vitalsMod: { hr: 160, bpSys: 70, spO2: 92, temp: 39.5, rr: 45 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Antibiotics', 'Fluids'], vbgClinicalState: "septic_shock", recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'Oxygen'] },
      { id: 'PA002', title: 'Severe Croup', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 3), patientProfileTemplate: "A {age}-year-old. Barking cough, stridor.", presentingComplaint: 'Stridor', instructorBrief: { progression: "Upper airway obstruction. Keep calm.", interventions: ["Neb Adrenaline", "Dexamethasone"], learningObjectives: ["Croup scoring", "Neb Adrenaline indications"] }, vitalsMod: { hr: 150, bpSys: 95, spO2: 93, rr: 50 }, deterioration: { active: true, rate: 0.08, type: 'respiratory' }, stabilisers: ['NebAdrenaline', 'Dexamethasone'], recommendedActions: ['Obs', 'Oxygen', 'NebAdrenaline', 'Dexamethasone'] },
      { id: 'PA003', title: 'Status Epilepticus', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(2, 10), patientProfileTemplate: "A {age}-year-old. Seizing > 10 mins.", presentingComplaint: 'Seizure', instructorBrief: { progression: "Prolonged seizure. Hypoxia risk.", interventions: ["Midazolam/Lorazepam", "RSI"], learningObjectives: ["APLS Seizure Algorithm"] }, vitalsMod: { hr: 140, bpSys: 100, spO2: 88, rr: 10, gcs: 3 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Midazolam', 'Lorazepam', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Midazolam', 'Lorazepam', 'RSI'] },
      { id: 'PA004', title: 'Anaphylaxis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(4, 12), patientProfileTemplate: "A {age}-year-old. Nut allergy. Swollen lips, wheeze.", presentingComplaint: 'Anaphylaxis', instructorBrief: { progression: "Airway compromise.", interventions: ["IM Adrenaline", "Nebs", "Fluids"], learningObjectives: ["Paeds Anaphylaxis"] }, vitalsMod: { hr: 155, bpSys: 80, spO2: 91, rr: 35 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Adrenaline', 'Nebs'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Adrenaline', 'Nebs', 'Fluids', 'Hydrocortisone'] },
      { id: 'PA005', title: 'Bronchiolitis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 4-month-old. 3 days coryza. Breathless.", presentingComplaint: 'DIB', instructorBrief: { progression: "Resp failure. Apnoeas.", interventions: ["High Flow/CPAP", "Suction"], learningObjectives: ["Bronchiolitis escalation"] }, vitalsMod: { hr: 170, bpSys: 80, spO2: 86, rr: 65 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, stabilisers: ['Oxygen', 'CPAP', 'NIV'], recommendedActions: ['Obs', 'IV Access', 'Suction', 'Oxygen', 'CPAP', 'Fluids'] },
      { id: 'PA006', title: 'Paediatric DKA', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(6, 16), patientProfileTemplate: "A {age}-year-old. New onset polyuria/polydipsia. Vomiting.", presentingComplaint: 'Vomiting & Lethargy', instructorBrief: { progression: "Severe Acidosis. Cerebral Edema risk.", interventions: ["Slow Fluids", "Insulin (Delay)"], learningObjectives: ["Paeds DKA Fluids", "Cerebral Edema"] }, vitalsMod: { hr: 130, bpSys: 95, spO2: 98, rr: 30, bm: 28 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, vbgClinicalState: "dka_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'InsulinDextrose'] },
      { id: 'PA007', title: 'SVT', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(0, 12), patientProfileTemplate: "A {age}-year-old. Pale, irritable. HR > 220.", presentingComplaint: 'Palpitations/Poor Feeding', instructorBrief: { progression: "Stable vs Unstable SVT.", interventions: ["Vagal Manoeuvres", "Adenosine", "Cardioversion"], learningObjectives: ["Paeds SVT management"] }, vitalsMod: { hr: 240, bpSys: 85, spO2: 95 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, ecg: { type: "SVT", findings: "Narrow Complex Tachycardia > 220bpm" }, recommendedActions: ['Obs', 'IV Access', 'Manoeuvres', 'Adenosine', 'Cardioversion'] },
      { id: 'PA008', title: 'Intussusception', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(0, 2), patientProfileTemplate: "A {age}-year-old. Episodic crying, drawing up legs. 'Redcurrant jelly' stool.", presentingComplaint: 'Abdo Pain', instructorBrief: { progression: "Fluid depletion and shock. Bowel ischaemia.", interventions: ["Fluids", "Air Enema (Radiology)", "Surgery"], learningObjectives: ["Intussusception diagnosis", "Fluid resus"] }, vitalsMod: { hr: 160, bpSys: 85, spO2: 98, rr: 35 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Fluids', 'AirEnema', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'AirEnema', 'Analgesia', 'Surgery'] },
      { id: 'PA009', title: 'Button Battery Ingestion', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 4), patientProfileTemplate: "A {age}-year-old. Swallowed 'something shiny' 2hrs ago. Hematemesis.", presentingComplaint: 'Haematemesis', instructorBrief: { progression: "Aorto-oesophageal fistula. Catastrophic bleed.", interventions: ["Massive Haemorrhage Protocol", "Theatre"], learningObjectives: ["Button battery time-criticality", "Fistula risk"] }, vitalsMod: { hr: 150, bpSys: 80, spO2: 94, rr: 30 }, deterioration: { active: true, rate: 0.2, type: 'shock' }, stabilisers: ['Blood', 'TXA', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Blood', 'TXA', 'Surgery'] },
      { id: 'PA010', title: 'Duct Dependent Collapse', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 5-day-old neonate. Sudden collapse at home. Pale and mottled.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Closing ductus arteriosus. Cardiac failure.", interventions: ["Prostaglandin (Dinoprostone)", "Intubation", "Fluids"], learningObjectives: ["Neonatal collapse diff dx", "Prostin use"] }, vitalsMod: { hr: 180, bpSys: 55, spO2: 80, rr: 60, bm: 3.5 }, deterioration: { active: true, rate: 0.15, type: 'cardiac' }, stabilisers: ['Prostin', 'Fluids', 'RSI'], ecg: { type: "Sinus Tachy", findings: "Sinus Tachy" }, recommendedActions: ['Obs', 'IV Access', 'Prostin', 'Fluids', 'RSI', 'Antibiotics'] },
      { id: 'PT001', title: 'NAI (Non-Accidental)', category: 'Trauma', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(0, 2), patientProfileTemplate: "A {age}-year-old. 'Fell off sofa'. Bruising to ears/neck.", presentingComplaint: 'Injury', instructorBrief: { progression: "Safeguarding concern. Thorough survey needed.", interventions: ["Skeletal Survey", "Social Services"], learningObjectives: ["Recognising NAI", "Safeguarding"] }, vitalsMod: { hr: 110, bpSys: 90, spO2: 99 }, deterioration: { active: false, rate: 0 }, recommendedActions: ['Obs', 'Analgesia'] },
      { id: 'PT002', title: 'Paediatric Head Injury', category: 'Trauma', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(2, 8), patientProfileTemplate: "A {age}-year-old. Fall 2m onto concrete. Vomiting.", presentingComplaint: 'Head Injury', instructorBrief: { progression: "Intracranial bleed.", interventions: ["CT Head", "Neuroobs", "RSI"], learningObjectives: ["PECARN Rules", "Paeds Head Injury"] }, vitalsMod: { hr: 90, bpSys: 110, spO2: 98, gcs: 13 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, recommendedActions: ['Obs', 'IV Access', 'RSI', 'TXA', 'Oxygen'] },
      { id: 'CA001', title: 'Adult VF Arrest', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 80), patientProfileTemplate: "Adult Male. Collapsed. Witnessed.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "VF Arrest.", interventions: ["CPR", "Shock", "Adrenaline", "Amiodarone"], learningObjectives: ["ALS Algorithm"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false, rate: 0 }, ecg: { type: "VF", findings: "VF" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV', 'Amiodarone'] },
      { id: 'CA002', title: 'Paediatric PEA Arrest', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 8), patientProfileTemplate: "Child. Found unresponsive in bed.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "PEA Arrest. Hypoxia likely cause.", interventions: ["CPR", "Airway", "Adrenaline"], learningObjectives: ["APLS Arrest", "4Hs 4Ts"] }, vitalsMod: { hr: 40, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false, rate: 0 }, ecg: { type: "PEA", findings: "Slow electrical activity, no pulse" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV', 'Bagging', 'Fluids'] },
      { id: 'OB001', title: 'Cord Prolapse', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "38 weeks pregnant. Waters broke. Loop of cord visible.", presentingComplaint: 'Cord Prolapse', instructorBrief: { progression: "Fetal hypoxia. Obstetric emergency.", interventions: ["Elevate presenting part", "Emergency C-Section"], learningObjectives: ["Cord prolapse management"] }, vitalsMod: { hr: 100, bpSys: 120, spO2: 99 }, deterioration: { active: false, rate: 0 }, recommendedActions: ['Obs', 'IV Access', 'Delivery', 'Manoeuvres', 'Oxygen', 'Fluids', 'Surgery'] },
      { id: 'OB002', title: 'Shoulder Dystocia', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "In labour. Head delivered, body stuck.", presentingComplaint: 'Stuck Baby', instructorBrief: { progression: "Turtle sign. Fetal compromise.", interventions: ["McRoberts", "Suprapubic Pressure"], learningObjectives: ["HELPERR Mnemonic"] }, vitalsMod: { hr: 110, bpSys: 130, spO2: 98 }, deterioration: { active: false, rate: 0 }, recommendedActions: ['Obs', 'IV Access', 'Manoeuvres', 'Delivery', 'Oxytocin', 'Analgesia'] },
      { id: 'OB003', title: 'Ruptured Ectopic', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 35), patientProfileTemplate: "A {age}-year-old female. Severe RIF pain and syncope. Positive pregnancy test.", presentingComplaint: 'Abdo Pain & Collapse', instructorBrief: { progression: "Intra-abdominal haemorrhage. Shock.", interventions: ["Blood", "Surgery", "Anti-D"], learningObjectives: ["Ectopic recognition", "Haemorrhage management"] }, vitalsMod: { hr: 130, bpSys: 85, spO2: 98, rr: 24, gcs: 14 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Blood', 'Surgery', 'Fluids'], vbgClinicalState: "haemorrhagic_shock", recommendedActions: ['Obs', 'IV Access', 'Blood', 'Surgery', 'AntiD', 'Fluids', 'Analgesia'] },
      { id: 'OB004', title: 'Eclampsia', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "36 weeks pregnant. Brought in seizing.", presentingComplaint: 'Seizure', instructorBrief: { progression: "Eclamptic seizure. Airway risk.", interventions: ["Magnesium Sulphate", "BP Control", "Delivery"], learningObjectives: ["Eclampsia management", "Mag Sulph dosing"] }, vitalsMod: { hr: 120, bpSys: 170, spO2: 92, rr: 10, gcs: 3 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['MagSulph', 'Labetalol', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'MagSulph', 'Labetalol', 'Delivery', 'RSI'] },
      { id: 'OB005', title: 'Amniotic Fluid Embolism', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "In active labour. Sudden collapse and cyanosis.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Cardiovascular collapse and coagulopathy (DIC).", interventions: ["CPR (if arrest)", "Massive Transfusion", "Perimortem C-Section?"], learningObjectives: ["AFE recognition", "Maternal arrest modification"] }, vitalsMod: { hr: 150, bpSys: 60, spO2: 75, rr: 35, gcs: 8 }, deterioration: { active: true, rate: 0.2, type: 'shock' }, stabilisers: ['Blood', 'TXA', 'Delivery'], recommendedActions: ['Obs', 'IV Access', 'Blood', 'TXA', 'Delivery', 'CPR', 'Hysterotomy'] },
      { id: 'AM039', title: 'Pericardial Tamponade', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. 2 weeks post-viral illness. Severe dyspnoea and chest heaviness.", presentingComplaint: 'Dyspnoea & Syncope', instructorBrief: { progression: "Beck's Triad. Obstructive Shock.", interventions: ["Fluids (Temporising)", "Pericardiocentesis", "Surgery"], learningObjectives: ["Beck's Triad", "Electrical Alternans"] }, vitalsMod: { hr: 130, bpSys: 85, spO2: 92, rr: 30 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Pericardiocentesis', 'Surgery'], ecg: { type: "Sinus Tachy", findings: "Small voltages, Electrical Alternans" }, recommendedActions: ['Obs', 'IV Access', 'Pericardiocentesis', 'Fluids', 'Surgery'] },
      { id: 'AM040', title: 'Wellens Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(45, 65), patientProfileTemplate: "A {age}-year-old. Had chest pain earlier, now pain free.", presentingComplaint: 'Resolved Chest Pain', instructorBrief: { progression: "Critical LAD stenosis. Risk of massive anterior MI if stressed.", interventions: ["Aspirin", "PPCI Referral (Urgent)", "Avoid Stress Test"], learningObjectives: ["Wellens ECG signs", "Do not exercise test"] }, vitalsMod: { hr: 70, bpSys: 130, spO2: 98 }, deterioration: { active: false, rate: 0 }, ecg: { type: "Sinus Rhythm", findings: "Deeply inverted T waves V2-V3 (Type B)" }, recommendedActions: ['Obs', 'IV Access', 'Aspirin', 'Clopidogrel'] },
      { id: 'AM041', title: 'Massive Haemoptysis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 75), patientProfileTemplate: "A {age}-year-old smoker. Coughing up cup-fulls of bright red blood.", presentingComplaint: 'Haemoptysis', instructorBrief: { progression: "Airway obstruction and hypovolaemia.", interventions: ["Intubation (Large tube)", "Lay on affected side", "TXA"], learningObjectives: ["Bronchial artery anatomy", "Positioning"] }, vitalsMod: { hr: 125, bpSys: 100, spO2: 88, rr: 28 }, deterioration: { active: true, rate: 0.15, type: 'airway' }, stabilisers: ['RSI', 'TXA'], recommendedActions: ['Obs', 'IV Access', 'RSI', 'TXA', 'Blood', 'Suction', 'Oxygen'] },
      { id: 'AM042', title: 'Brugada Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(25, 45), patientProfileTemplate: "A {age}-year-old. Syncope while resting/sleeping. Family history of sudden death.", presentingComplaint: 'Syncope', instructorBrief: { progression: "Risk of polymorphic VT/VF.", interventions: ["Avoid fever/certain drugs", "Cardiology Referral", "ICD consideration"], learningObjectives: ["Brugada ECG types", "Sodium channel blockers"] }, vitalsMod: { hr: 75, bpSys: 120, spO2: 99 }, deterioration: { active: false, rate: 0 }, ecg: { type: "Sinus Rhythm", findings: "Coved ST elevation V1-V2 (Type 1)" }, recommendedActions: ['Obs', 'IV Access'] },
      { id: 'AM043', title: 'Myasthenia Gravis Crisis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old with Myasthenia Gravis. Increasing shortness of breath and swallowing difficulty.", presentingComplaint: 'Dyspnoea & Weakness', instructorBrief: { progression: "Type 2 Respiratory Failure (Neuromuscular).", interventions: ["NIV", "Intubation", "IVIG/Plasma Exchange"], learningObjectives: ["FVC monitoring", "Cholinergic vs Myasthenic"] }, vitalsMod: { hr: 110, bpSys: 140, spO2: 92, rr: 30 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['NIV', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'NIV', 'RSI'] },
      { id: 'AM044', title: 'Vertebral Artery Dissection', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(25, 45), patientProfileTemplate: "A {age}-year-old. Neck pain after yoga/chiropractor. Vertigo and ataxia.", presentingComplaint: 'Neck Pain & Dizziness', instructorBrief: { progression: "Posterior circulation stroke.", interventions: ["CT Angiogram", "Antiplatelets/Anticoagulation"], learningObjectives: ["Dissection risk factors", "Cerebellar signs"] }, vitalsMod: { hr: 80, bpSys: 145, spO2: 98, gcs: 14 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, recommendedActions: ['Obs', 'IV Access', 'Aspirin', 'Analgesia'] },
      { id: 'AM045', title: 'Phaeochromocytoma Crisis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Sudden thunderclap headache, palpitations, profuse sweating.", presentingComplaint: 'Headache', instructorBrief: { progression: "Hypertensive crisis. End organ damage.", interventions: ["Alpha Blockers (Phentolamine)", "Beta Blockers (AFTER Alpha)"], learningObjectives: ["Alpha before Beta rule", "Catecholamine surge"] }, vitalsMod: { hr: 160, bpSys: 240, bpDia: 130, spO2: 96 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Labetalol', 'MagSulph'], recommendedActions: ['Obs', 'IV Access', 'Labetalol', 'MagSulph', 'Phentolamine'] },
      { id: 'AM046', title: 'Pituitary Apoplexy', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Sudden severe headache and visual loss (bitemporal).", presentingComplaint: 'Headache & Blindness', instructorBrief: { progression: "Adrenal insufficiency and mass effect.", interventions: ["Hydrocortisone", "Urgent Neurosurgery"], learningObjectives: ["Pituitary anatomy", "Steroid replacement"] }, vitalsMod: { hr: 110, bpSys: 90, spO2: 98, gcs: 14 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Hydrocortisone', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Hydrocortisone', 'Surgery', 'Fluids'] },
      { id: 'AM047', title: 'Ludwig\'s Angina', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Dental abscess. 'Hot potato' voice, woody neck swelling.", presentingComplaint: 'Sore Throat & Swelling', instructorBrief: { progression: "Airway obstruction.", interventions: ["Antibiotics", "Awake Fibreoptic Intubation", "Surgical Airway"], learningObjectives: ["Airway assessment", "FONA anticipation"] }, vitalsMod: { hr: 120, bpSys: 130, spO2: 94, rr: 26, temp: 39.0 }, deterioration: { active: true, rate: 0.15, type: 'airway' }, stabilisers: ['Antibiotics', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'NebAdrenaline', 'Dexamethasone', 'RSI', 'FONA'] },
      { id: 'AM048', title: 'Severe Malaria', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 60), patientProfileTemplate: "A {age}-year-old. Returned from Kenya 1 week ago. Flu-like symptoms, now confused.", presentingComplaint: 'Fever & Confusion', instructorBrief: { progression: "Cerebral Malaria. Haemolysis.", interventions: ["Artesunate/Quinine", "Fluids", "Glucose"], learningObjectives: ["Travel history", "Parasitaemia"] }, vitalsMod: { hr: 130, bpSys: 90, spO2: 92, temp: 40.2, gcs: 11 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Antibiotics', 'Fluids'], vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'InsulinDextrose'] },
      { id: 'AM049', title: 'Necrotising Fasciitis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(40, 70), patientProfileTemplate: "A {age}-year-old. Minor scratch on leg. Now severe pain out of proportion to exam.", presentingComplaint: 'Leg Pain', instructorBrief: { progression: "Rapid spread. Septic shock.", interventions: ["Immediate Surgery (Debridement)", "Broad Spectrum Abx"], learningObjectives: ["LRINEC Score", "Pain out of proportion"] }, vitalsMod: { hr: 140, bpSys: 85, spO2: 94, temp: 39.5 }, deterioration: { active: true, rate: 0.2, type: 'shock' }, stabilisers: ['Surgery', 'Antibiotics'], vbgClinicalState: "septic_shock", recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Antibiotics', 'Fluids', 'Analgesia'] },
      { id: 'TX001', title: 'Beta-Blocker Overdose', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Took 2 months supply of Bisoprolol.", presentingComplaint: 'Overdose', instructorBrief: { progression: "Profound bradycardia and shock.", interventions: ["Glucagon", "High Dose Insulin", "Lipid Emulsion"], learningObjectives: ["HDI protocol", "Glucagon dosing"] }, vitalsMod: { hr: 35, bpSys: 65, spO2: 94, gcs: 12, bm: 3.5 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Glucagon', 'InsulinDextrose', 'Pacing'], ecg: { type: "Sinus Brady", findings: "Severe Bradycardia, 1st deg block" }, recommendedActions: ['Obs', 'IV Access', 'Glucagon', 'InsulinDextrose', 'Lipid', 'Pacing'] },
      { id: 'TX002', title: 'Digoxin Toxicity', category: 'Toxicology', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(70, 90), patientProfileTemplate: "A {age}-year-old. Confused, vomiting, seeing yellow halos.", presentingComplaint: 'Confusion & Vomiting', instructorBrief: { progression: "Arrhythmias (Bidirectional VT).", interventions: ["Digibind (Fab fragments)", "Magnesium", "Atropine"], learningObjectives: ["Digoxin ECG effects", "Salvador Dali moustache"] }, vitalsMod: { hr: 45, bpSys: 100, spO2: 96 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, ecg: { type: "Sinus Brady", findings: "Reverse tick appearance, frequent VEs" }, recommendedActions: ['Obs', 'IV Access', 'Atropine', 'MagSulph', 'Digibind'] },
      { id: 'TX003', title: 'Iron Overdose', category: 'Toxicology', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(2, 6), patientProfileTemplate: "A {age}-year-old. Ate 'red sweets' (Ferrous Sulphate) 4 hours ago. Vomiting blood.", presentingComplaint: 'Haematemesis', instructorBrief: { progression: "Corrosive GI injury. Severe metabolic acidosis.", interventions: ["Desferrioxamine", "Whole Bowel Irrigation"], learningObjectives: ["Iron toxicity stages", "Opaque pills on X-ray"] }, vitalsMod: { hr: 150, bpSys: 80, spO2: 95, rr: 40 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Lactulose', 'Desferrioxamine'] },
      { id: 'TX004', title: 'Local Anaesthetic Toxicity', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Had nerve block. Now ringing in ears and perioral numbness.", presentingComplaint: 'Tinnitus & Numbness', instructorBrief: { progression: "Seizures then Cardiac Arrest (LAST).", interventions: ["Intralipid 20%", "Stop injection"], learningObjectives: ["LAST protocol", "Lipid dosing"] }, vitalsMod: { hr: 110, bpSys: 140, spO2: 99 }, deterioration: { active: true, rate: 0.15, type: 'neuro' }, stabilisers: ['Lipid', 'Midazolam'], recommendedActions: ['Obs', 'IV Access', 'Lipid', 'Midazolam', 'Oxygen'] },
      { id: 'TX005', title: 'Ethylene Glycol', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Drank antifreeze. Appears drunk but breath smells sweet.", presentingComplaint: 'Intoxication', instructorBrief: { progression: "High anion gap acidosis. Renal failure.", interventions: ["Fomepizole/Ethanol", "Dialysis"], learningObjectives: ["Osmolar gap", "Wood's lamp urine"] }, vitalsMod: { hr: 100, bpSys: 130, spO2: 96, rr: 28 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Fomepizole'] },
      { id: 'AT009', title: 'Traumatic Amputation', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Industrial accident. Hand amputated at wrist.", presentingComplaint: 'Amputation', instructorBrief: { progression: "Exsanguination.", interventions: ["Tourniquet", "Direct Pressure", "Stump retrieval"], learningObjectives: ["Tourniquet application", "Amputated part care"] }, vitalsMod: { hr: 130, bpSys: 90, spO2: 98 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Blood', 'TXA', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Blood', 'TXA', 'Surgery', 'Analgesia', 'Tourniquet'] },
      { id: 'AT010', title: 'Compartment Syndrome', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Tib/Fib fracture 4 hours ago (casted). Increasing severe pain.", presentingComplaint: 'Leg Pain', instructorBrief: { progression: "Ischaemia and necrosis.", interventions: ["Split Cast/Dressings", "Fasciotomy"], learningObjectives: ["6 Ps of ischaemia", "Pain on passive stretch"] }, vitalsMod: { hr: 110, bpSys: 140, spO2: 99 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Surgery', 'Analgesia'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Analgesia'] },
      { id: 'AT011', title: 'Electrical Injury', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old electrician. Thrown across room by high voltage.", presentingComplaint: 'Electrocution', instructorBrief: { progression: "Rhabdomyolysis and arrhythmias.", interventions: ["ECG Monitoring", "Fluid (high target)", "CK check"], learningObjectives: ["AC vs DC injury", "Fluid targets in burns"] }, vitalsMod: { hr: 120, bpSys: 130, spO2: 98, ecg: "Ectopics" }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, ecg: { type: "AF", findings: "Irregular with burns evident" }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Analgesia'] },
      { id: 'AT012', title: 'Suspension Trauma', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(25, 55), patientProfileTemplate: "A {age}-year-old climber. Stuck in harness for 2 hours. Conscious.", presentingComplaint: 'Leg Numbness', instructorBrief: { progression: "Reflow syndrome/Cardiac arrest upon lying flat.", interventions: ["Sit up/crouch", "Gradual recline", "Fluids"], learningObjectives: ["Suspension syncope", "Rescue death"] }, vitalsMod: { hr: 115, bpSys: 90, spO2: 96 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, recommendedActions: ['Obs', 'IV Access', 'Fluids'] },
      { id: 'AT013', title: 'Open Chest Wound', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Stabbed chest. Bubbling wound.", presentingComplaint: 'Stab Wound', instructorBrief: { progression: "Sucking chest wound. Pneumothorax.", interventions: ["3-sided dressing", "Chest Drain"], learningObjectives: ["Occlusive dressing logic", "Drain insertion"] }, vitalsMod: { hr: 130, bpSys: 95, spO2: 88, rr: 32 }, deterioration: { active: true, rate: 0.15, type: 'respiratory' }, stabilisers: ['SeldingerDrain', 'SurgicalDrain'], recommendedActions: ['Obs', 'IV Access', 'SurgicalDrain', 'Oxygen', 'Analgesia', 'SeldingerDrain'] },
      { id: 'PA011', title: 'Kawasaki Disease', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(2, 5), patientProfileTemplate: "A {age}-year-old. Fever > 5 days. Strawberry tongue, peeling fingers.", presentingComplaint: 'Fever & Rash', instructorBrief: { progression: "Coronary artery aneurysms.", interventions: ["IVIG", "Aspirin (High dose)", "Echo"], learningObjectives: ["CRASH and Burn criteria", "Aspirin in paeds"] }, vitalsMod: { hr: 140, bpSys: 95, spO2: 98, temp: 39.5 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Paracetamol'], recommendedActions: ['Obs', 'IV Access', 'Aspirin', 'Fluids', 'Analgesia'] },
      { id: 'PA012', title: 'Sickle Cell Crisis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(5, 12), patientProfileTemplate: "A {age}-year-old. Known Sickle Cell. Severe chest pain and hypoxia.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Acute Chest Syndrome.", interventions: ["Oxygen", "Opioids", "Antibiotics", "Exchange Transfusion"], learningObjectives: ["Acute Chest recognition", "Analgesia ladder"] }, vitalsMod: { hr: 150, bpSys: 100, spO2: 85, rr: 40 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['Oxygen', 'Analgesia', 'Antibiotics'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'Analgesia', 'Antibiotics', 'Fluids'] },
      { id: 'PA013', title: 'Foreign Body Aspiration', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(2, 4), patientProfileTemplate: "A {age}-year-old. Playing with lego. Sudden onset cough/stridor.", presentingComplaint: 'Choking', instructorBrief: { progression: "Total obstruction. Arrest.", interventions: ["Back blows", "Magill's forceps", "RSI (Push tube)"], learningObjectives: ["Choking algorithm", "Unilateral wheeze"] }, vitalsMod: { hr: 160, bpSys: 90, spO2: 88, rr: 45 }, deterioration: { active: true, rate: 0.2, type: 'airway' }, stabilisers: ['Manoeuvres'], recommendedActions: ['Obs', 'Oxygen', 'Manoeuvres', 'RSI', 'Magills'] },
      { id: 'PA014', title: 'Testicular Torsion', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(10, 16), patientProfileTemplate: "A {age}-year-old. Sudden severe groin pain and vomiting.", presentingComplaint: 'Testicular Pain', instructorBrief: { progression: "Ischaemia/Loss of testis.", interventions: ["Urgent Urology/Surgery", "Analgesia"], learningObjectives: ["Time to theatre (<6hrs)", "Do not wait for Ultrasound"] }, vitalsMod: { hr: 110, bpSys: 120, spO2: 99 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Surgery', 'Analgesia'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Analgesia'] },
      { id: 'PA015', title: 'Septic Arthritis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(3, 8), patientProfileTemplate: "A {age}-year-old. High fever. Refusing to walk on right leg.", presentingComplaint: 'Limp & Fever', instructorBrief: { progression: "Joint destruction. Sepsis.", interventions: ["IV Antibiotics", "Orthopaedic Washout", "Kocher's Criteria"], learningObjectives: ["Kocher's Criteria", "Transient synovitis diff dx"] }, vitalsMod: { hr: 130, bpSys: 100, spO2: 98, temp: 39.2 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Antibiotics', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Surgery', 'Analgesia'] },
      { id: 'OB006', title: 'Postpartum Haemorrhage', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Just delivered baby. Continuous heavy bleeding.", presentingComplaint: 'Haemorrhage', instructorBrief: { progression: "Major Haemorrhage (4 Ts).", interventions: ["Uterine Massage", "Oxytocin/Ergometrine", "TXA", "MTP"], learningObjectives: ["4 Ts of PPH", "Bimanual compression"] }, vitalsMod: { hr: 140, bpSys: 70, spO2: 94, rr: 28 }, deterioration: { active: true, rate: 0.2, type: 'shock' }, stabilisers: ['Oxytocin', 'Ergometrine', 'Blood', 'TXA'], vbgClinicalState: "haemorrhagic_shock", recommendedActions: ['Obs', 'IV Access', 'Oxytocin', 'Ergometrine', 'Blood', 'TXA', 'Carboprost'] },
      { id: 'OB007', title: 'Ovarian Torsion', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 35), patientProfileTemplate: "A {age}-year-old. Sudden onset severe unilateral iliac fossa pain. Vomiting.", presentingComplaint: 'Abdo Pain', instructorBrief: { progression: "Ovarian ischaemia.", interventions: ["Analgesia", "Gynae Referral (Laparoscopy)"], learningObjectives: ["Ultrasound utility", "Torsion risk factors"] }, vitalsMod: { hr: 115, bpSys: 130, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Surgery', 'Analgesia'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Analgesia'] },
      { id: 'OB008', title: 'Peripartum Cardiomyopathy', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(25, 40), patientProfileTemplate: "A {age}-year-old. 1 week post-partum. Severe orthopnoea and pedal oedema.", presentingComplaint: 'Heart Failure', instructorBrief: { progression: "Acute Pulmonary Oedema/Cardiogenic Shock.", interventions: ["Diuretics", "GTN", "Echo"], learningObjectives: ["PPCM diagnosis", "Fluid management in failure"] }, vitalsMod: { hr: 125, bpSys: 140, spO2: 88, rr: 30 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, stabilisers: ['Furosemide', 'GTN', 'CPAP'], ecg: { type: "Sinus Tachy", findings: "Global T wave inversion" }, recommendedActions: ['Obs', 'IV Access', 'Furosemide', 'GTN', 'CPAP', 'Oxygen'] },
      { id: 'EL006', title: 'Acute Mesenteric Ischaemia', category: 'Medical', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "A {age}-year-old with AF. Generalised abdo pain. Lactate 6.0.", presentingComplaint: 'Severe Abdo Pain', instructorBrief: { progression: "Bowel necrosis and perforation.", interventions: ["Surgery/IR", "Antibiotics", "Heparin"], learningObjectives: ["Pain out of proportion", "Lactate significance"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 94, rr: 26 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Surgery', 'Antibiotics'], vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Antibiotics', 'Fluids', 'Analgesia', 'Heparin'] },
      { id: 'EL007', title: 'Temporal Arteritis', category: 'Medical', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(70, 85), patientProfileTemplate: "A {age}-year-old. Severe temporal headache and jaw claudication.", presentingComplaint: 'Headache', instructorBrief: { progression: "Permanent blindness (Ischaemic optic neuropathy).", interventions: ["High Dose Steroids (Prednisolone)", "Ophthalmology/Rheum"], learningObjectives: ["GCA symptoms", "Steroid urgency"] }, vitalsMod: { hr: 80, bpSys: 140, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Dexamethasone', 'Hydrocortisone'], recommendedActions: ['Obs', 'IV Access', 'Dexamethasone', 'Analgesia'] },
      { id: 'AM050', title: 'Severe Acute Pancreatitis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Severe epigastric pain radiating to back. Alcohol history.", presentingComplaint: 'Epigastric Pain', instructorBrief: { progression: "SIRS response. Hypocalcaemia. ARDS risk.", interventions: ["Aggressive Fluids", "Analgesia", "Calcium (if low)"], learningObjectives: ["Glasgow Score for Pancreatitis", "Fluid sequestration"] }, vitalsMod: { hr: 125, bpSys: 100, spO2: 94, rr: 24, temp: 38.2 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Fluids', 'Analgesia'], vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Analgesia', 'Calcium'] },
      { id: 'AM051', title: 'Hepatic Encephalopathy', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(45, 70), patientProfileTemplate: "A {age}-year-old with cirrhosis. Found confused and flapping tremor.", presentingComplaint: 'Confusion', instructorBrief: { progression: "Risk of airway compromise and cerebral oedema.", interventions: ["Lactulose (Enema)", "Rifaximin", "Treat precipitant"], learningObjectives: ["Ammonia levels", "West Haven Criteria"] }, vitalsMod: { hr: 90, bpSys: 110, spO2: 96, gcs: 12 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Lactulose'], recommendedActions: ['Obs', 'IV Access', 'Lactulose', 'Fluids', 'Rifaximin'] },
      { id: 'AM052', title: 'Spontaneous Bacterial Peritonitis', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(40, 65), patientProfileTemplate: "A {age}-year-old with ascites. Abdominal pain and fever.", presentingComplaint: 'Abdo Pain & Fever', instructorBrief: { progression: "Septic shock.", interventions: ["Ascitic Tap (Urgent)", "IV Albumin", "Antibiotics"], learningObjectives: ["SBP diagnosis (Neutrophils >250)", "Albumin indications"] }, vitalsMod: { hr: 115, bpSys: 95, spO2: 95, temp: 38.5 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Antibiotics', 'Fluids'], vbgClinicalState: "septic_shock", recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Fluids', 'Analgesia'] },
      { id: 'AM053', title: 'Infective Endocarditis', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(25, 60), patientProfileTemplate: "A {age}-year-old IVDU. 3 weeks fever, new murmur, malaise.", presentingComplaint: 'Fever & SOB', instructorBrief: { progression: "Valve failure and heart failure. Embolic events.", interventions: ["Blood Cultures x3", "Antibiotics", "Echo"], learningObjectives: ["Duke Criteria", "Embolic phenomena"] }, vitalsMod: { hr: 110, bpSys: 110, spO2: 93, temp: 39.0 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, stabilisers: ['Antibiotics', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Oxygen', 'Fluids'] },
      { id: 'AM054', title: 'Severe Aortic Stenosis', category: 'Medical', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "A {age}-year-old. Collapsed on exertion. Systolic murmur.", presentingComplaint: 'Syncope', instructorBrief: { progression: "Cardiogenic shock. Pre-load dependent.", interventions: ["Cautious Fluids", "Treat Arrhythmia", "Avoid GTN"], learningObjectives: ["Fixed output state", "Medications to avoid"] }, vitalsMod: { hr: 90, bpSys: 95, spO2: 94 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, ecg: { type: "Sinus Rhythm", findings: "LVH with Strain" }, recommendedActions: ['Obs', 'IV Access', 'Fluids'] },
      { id: 'AM055', title: 'HOCM Arrest', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 30), patientProfileTemplate: "A {age}-year-old athlete. Collapsed mid-game.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "VF Arrest. Post-ROSC care critical.", interventions: ["Defibrillation", "Amiodarone", "Cooling"], learningObjectives: ["Hypertrophic Cardiomyopathy", "Screening family"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false, rate: 0 }, ecg: { type: "VF", findings: "VF -> Deep Q waves post ROSC" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV', 'Amiodarone'] },
      { id: 'AM056', title: 'Pre-excited AF (WPW)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Palpitations. Known WPW.", presentingComplaint: 'Palpitations', instructorBrief: { progression: "Irregular Broad Complex Tachycardia. Risk of VF.", interventions: ["DC Cardioversion", "Procainamide/Flecainide", "AVOID Adenosine/Blockers"], learningObjectives: ["FBI (Fast Broad Irregular)", "Contraindicated drugs"] }, vitalsMod: { hr: 180, bpSys: 90, spO2: 96 }, deterioration: { active: true, rate: 0.2, type: 'cardiac' }, ecg: { type: "AF", findings: "Irregular Broad Complex Tachycardia" }, recommendedActions: ['Obs', 'IV Access', 'Cardioversion', 'Amiodarone'] },
      { id: 'AM057', title: 'Acute Angle Closure Glaucoma', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(50, 80), patientProfileTemplate: "A {age}-year-old. Severe eye pain, vomiting, halos around lights.", presentingComplaint: 'Eye Pain & Vomiting', instructorBrief: { progression: "Permanent vision loss.", interventions: ["Acetazolamide", "Timolol/Pilocarpine", "Ophthalmology"], learningObjectives: ["Fixed mid-dilated pupil", "IOP reduction"] }, vitalsMod: { hr: 90, bpSys: 140, spO2: 98, pupils: "Fixed Mid-dilated R" }, deterioration: { active: false, rate: 0 }, stabilisers: ['Analgesia'], recommendedActions: ['Obs', 'IV Access', 'Analgesia', 'Antiemetic', 'Acetazolamide', 'TopicalEyeDrops'] },
      { id: 'AM058', title: 'Central Retinal Artery Occlusion', category: 'Medical', ageRange: 'Elderly', acuity: 'Majors', ageGenerator: () => getRandomInt(65, 85), patientProfileTemplate: "A {age}-year-old. Sudden painless loss of vision in one eye.", presentingComplaint: 'Vision Loss', instructorBrief: { progression: "Retinal infarction. Stroke workup needed.", interventions: ["Ocular Massage", "Timolol/Acetazolamide", "Stroke Team"], learningObjectives: ["Cherry red spot", "Embolic source"] }, vitalsMod: { hr: 75, bpSys: 150, spO2: 98 }, deterioration: { active: false, rate: 0 }, recommendedActions: ['Obs', 'IV Access', 'TopicalEyeDrops', 'Acetazolamide'] },
      { id: 'AM059', title: 'Adult Epiglottitis', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Severe sore throat, drooling, leaning forward.", presentingComplaint: 'Stridor & Drooling', instructorBrief: { progression: "Complete airway obstruction.", interventions: ["Neb Adrenaline", "Dexamethasone", "Awake Fibreoptic"], learningObjectives: ["Never examine throat", "Airway strategy"] }, vitalsMod: { hr: 120, bpSys: 130, spO2: 94, rr: 28, temp: 38.8 }, deterioration: { active: true, rate: 0.2, type: 'airway' }, stabilisers: ['NebAdrenaline', 'Dexamethasone', 'RSI'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'NebAdrenaline', 'Dexamethasone', 'RSI', 'FONA'] },
      { id: 'AM060', title: 'Quinsy', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(18, 35), patientProfileTemplate: "A {age}-year-old. Severe unilateral sore throat, trismus, uvula deviation.", presentingComplaint: 'Sore Throat', instructorBrief: { progression: "Airway compromise.", interventions: ["Needle Aspiration", "Antibiotics", "Dexamethasone"], learningObjectives: ["Quinsy vs Tonsillitis", "Drainage technique"] }, vitalsMod: { hr: 100, bpSys: 120, spO2: 98, temp: 38.5 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Antibiotics', 'Dexamethasone'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Dexamethasone', 'Analgesia'] },
      { id: 'AM061', title: 'PJP Pneumonia (HIV)', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(25, 50), patientProfileTemplate: "A {age}-year-old. Dry cough and exertional dyspnoea. HIV positive (non-compliant).", presentingComplaint: 'Dyspnoea', instructorBrief: { progression: "Hypoxia worsens significantly on exertion.", interventions: ["High Dose Co-trimoxazole", "Steroids (if hypoxic)"], learningObjectives: ["PJP presentation", "Exercise desaturation"] }, vitalsMod: { hr: 110, bpSys: 115, spO2: 92, rr: 24 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['Antibiotics', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'Antibiotics', 'Oxygen', 'Dexamethasone'] },
      { id: 'AM062', title: 'Tumour Lysis Syndrome', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 70), patientProfileTemplate: "A {age}-year-old. Started chemo yesterday for Leukaemia. Lethargic.", presentingComplaint: 'Lethargy', instructorBrief: { progression: "Hyperkalaemia, Hyperphosphataemia, Renal Failure.", interventions: ["Aggressive Hydration", "Rasburicase", "Calcium (if symptomatic)"], learningObjectives: ["Electrolyte disturbances", "Rasburicase indications"] }, vitalsMod: { hr: 90, bpSys: 100, spO2: 96 }, deterioration: { active: true, rate: 0.1, type: 'cardiac' }, vbgClinicalState: "hyperkalemia", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Calcium', 'InsulinDextrose', 'Rasburicase'] },
      { id: 'AM063', title: 'Exertional Rhabdomyolysis', category: 'Medical', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 35), patientProfileTemplate: "A {age}-year-old. First crossfit session yesterday. Severe muscle pain and dark urine.", presentingComplaint: 'Muscle Pain', instructorBrief: { progression: "AKI and Hyperkalaemia.", interventions: ["Aggressive IV Fluids (300ml/hr+)", "Monitor K+"], learningObjectives: ["CK levels", "Myoglobinuria"] }, vitalsMod: { hr: 100, bpSys: 125, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Fluids'], urine: { findings: "Blood +++ (Myoglobin)" }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Analgesia'] },
      { id: 'AM064', title: 'Hypertensive Emergency', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(40, 60), patientProfileTemplate: "A {age}-year-old. Headache, confusion, visual disturbance. BP 240/130.", presentingComplaint: 'Confusion', instructorBrief: { progression: "PRES or Intracranial Bleed.", interventions: ["Labetalol Infusion", "GTN Infusion", "CT Head"], learningObjectives: ["Rate of BP reduction (Max 25% first hour)"] }, vitalsMod: { hr: 90, bpSys: 240, bpDia: 130, spO2: 96, gcs: 13 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Labetalol', 'GTNInfusion'], recommendedActions: ['Obs', 'IV Access', 'Labetalol', 'GTNInfusion'] },
      { id: 'AT014', title: 'Blast Injury', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Explosion in closed space.", presentingComplaint: 'Polytrauma', instructorBrief: { progression: "Blast lung, tympanic rupture, bowel injury.", interventions: ["Airway support", "Chest Drain", "Trauma CT"], learningObjectives: ["Blast wave physics", "Blast lung management"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 88, rr: 30 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['Oxygen', 'SurgicalDrain'], recommendedActions: ['Obs', 'IV Access', 'Oxygen', 'SurgicalDrain', 'Fluids', 'Analgesia'] },
      { id: 'AT015', title: 'Traumatic Aortic Rupture', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. High speed deceleration (RTC). Chest pain.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Exsanguination.", interventions: ["Permissive Hypotension (strictly)", "Surgery/Stent"], learningObjectives: ["Widened mediastinum", "BP targets"] }, vitalsMod: { hr: 110, bpSys: 90, spO2: 94 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Surgery', 'Labetalol'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Labetalol', 'Blood', 'Analgesia'] },
      { id: 'AT016', title: 'Diaphragmatic Rupture', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Crush injury to abdomen. Bowel sounds in chest.", presentingComplaint: 'Dyspnoea', instructorBrief: { progression: "Respiratory compromise and bowel strangulation.", interventions: ["NG Tube (Caution)", "Surgery"], learningObjectives: ["CXR interpretation", "NGT path"] }, vitalsMod: { hr: 100, bpSys: 110, spO2: 92, rr: 26 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, chestXray: { findings: "NG tube coiling in chest, bowel loops visible" }, recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Analgesia'] },
      { id: 'AT017', title: 'Retrobulbar Haematoma', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 60), patientProfileTemplate: "A {age}-year-old. Punch to eye. Proptosis and loss of vision.", presentingComplaint: 'Eye Trauma', instructorBrief: { progression: "Permanent blindness < 2 hours.", interventions: ["Lateral Canthotomy (Immediate)", "Do not wait for CT"], learningObjectives: ["Canthotomy technique", "Orbital compartment syndrome"] }, vitalsMod: { hr: 90, bpSys: 140, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Surgery'], recommendedActions: ['Obs', 'IV Access', 'Canthotomy', 'Analgesia'] },
      { id: 'AT018', title: 'Knee Dislocation', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Rugby tackle. Deformity of knee. Foot cold.", presentingComplaint: 'Leg Injury', instructorBrief: { progression: "Popliteal artery injury.", interventions: ["Reduction (Immediate)", "Vascular Surgery"], learningObjectives: ["Vascular check pre/post reduction", "Hard signs of ischaemia"] }, vitalsMod: { hr: 110, bpSys: 130, spO2: 99 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Reduction'], recommendedActions: ['Obs', 'IV Access', 'Reduction', 'Surgery', 'Analgesia'] },
      { id: 'AT019', title: 'Ankle Fracture-Dislocation', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 60), patientProfileTemplate: "A {age}-year-old. Fall. Ankle severely deformed, skin tenting/blanching.", presentingComplaint: 'Ankle Injury', instructorBrief: { progression: "Skin necrosis and open fracture.", interventions: ["Immediate Reduction", "Backslab"], learningObjectives: ["Skin threat urgency", "Sedation reduction"] }, vitalsMod: { hr: 100, bpSys: 140, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Reduction', 'Plaster'], recommendedActions: ['Obs', 'IV Access', 'Reduction', 'Plaster', 'Analgesia'] },
      { id: 'AT020', title: 'Straddle Injury', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(10, 30), patientProfileTemplate: "A {age}-year-old. Fell onto bike crossbar. Blood at meatus.", presentingComplaint: 'Groin Pain', instructorBrief: { progression: "Urethral tear.", interventions: ["Do NOT catheterise", "Urology urgency", "Suprapubic Catheter"], learningObjectives: ["Urethral injury signs", "Retrograde urethrogram"] }, vitalsMod: { hr: 90, bpSys: 120, spO2: 99 }, deterioration: { active: false, rate: 0 }, recommendedActions: ['Obs', 'Analgesia'] },
      { id: 'AT021', title: 'Chemical Eye Burn', category: 'Trauma', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Splashed industrial cleaner (Alkali) in eye.", presentingComplaint: 'Eye Pain', instructorBrief: { progression: "Corneal melting.", interventions: ["Irrigation (Litres!)", "Check pH"], learningObjectives: ["Alkali vs Acid", "Morgan lens"] }, vitalsMod: { hr: 100, bpSys: 130, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Fluids'], recommendedActions: ['Obs', 'Irrigation', 'Analgesia'] },
      { id: 'AT022', title: 'Severe Maxillofacial Trauma', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Dashboard injury. Mid-face floating.", presentingComplaint: 'Facial Trauma', instructorBrief: { progression: "Airway obstruction (Blood/Teeth).", interventions: ["Sit up (if C-spine cleared)", "Suction", "Intubation (Difficult)"], learningObjectives: ["Le Fort fractures", "Airway adjuncts"] }, vitalsMod: { hr: 120, bpSys: 110, spO2: 92, rr: 28 }, deterioration: { active: true, rate: 0.1, type: 'airway' }, stabilisers: ['RSI', 'Suction'], recommendedActions: ['Obs', 'IV Access', 'Suction', 'RSI', 'Analgesia', 'Oxygen', 'FONA'] },
      { id: 'AT023', title: 'Impaled Object', category: 'Trauma', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Impaled on fence railing (Abdomen).", presentingComplaint: 'Impaled Object', instructorBrief: { progression: "Hemorrhage if removed.", interventions: ["Do NOT remove", "Stabilise object", "Theatre"], learningObjectives: ["Impaled object management"] }, vitalsMod: { hr: 115, bpSys: 105, spO2: 96 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Surgery'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Blood', 'Analgesia'] },
      { id: 'PA016', title: 'Pyloric Stenosis', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => 0, patientProfileTemplate: "A 5-week-old. Projectile vomiting after feeds. Hungry.", presentingComplaint: 'Vomiting', instructorBrief: { progression: "Dehydration and Hypochloraemic Metabolic Alkalosis.", interventions: ["Fluid Resus", "Correction of Alkalosis", "Surgery"], learningObjectives: ["VBG interpretation", "Olive mass"] }, vitalsMod: { hr: 160, bpSys: 75, spO2: 98, rr: 40, bm: 3.8 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, vbgClinicalState: "metabolic_alkalosis", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Surgery'] },
      { id: 'PA017', title: 'Malrotation & Volvulus', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 3-day-old. Bilious vomiting and distended abdomen.", presentingComplaint: 'Bilious Vomiting', instructorBrief: { progression: "Gut ischaemia and necrosis.", interventions: ["NG Tube", "Fluid Resus", "Urgent Surgery"], learningObjectives: ["Bilious vomiting is red flag", "Upper GI Contrast"] }, vitalsMod: { hr: 180, bpSys: 60, spO2: 90, rr: 60 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Surgery', 'Fluids'], recommendedActions: ['Obs', 'IV Access', 'Surgery', 'Fluids', 'Analgesia'] },
      { id: 'PA018', title: 'Congenital Adrenal Hyperplasia', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 2-week-old. Vomiting, weight loss. Ambiguous genitalia.", presentingComplaint: 'Failure to Thrive', instructorBrief: { progression: "Salt-wasting crisis (Low Na, High K). Shock.", interventions: ["Hydrocortisone", "Saline Bolus", "Glucose"], learningObjectives: ["CAH pathophysiology", "Hyperkalaemia in neonate"] }, vitalsMod: { hr: 170, bpSys: 55, spO2: 94, bm: 2.5 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, vbgClinicalState: "hyperkalemia", recommendedActions: ['Obs', 'IV Access', 'Hydrocortisone', 'Fluids', 'InsulinDextrose'] },
      { id: 'PA019', title: 'Pertussis (Whooping Cough)', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 3-month-old. Coughing spells turning blue. Apnoeas.", presentingComplaint: 'Cough & Cyanosis', instructorBrief: { progression: "Apnoea and bradycardia.", interventions: ["Oxygen", "Suction", "Antibiotics (Macrolide)"], learningObjectives: ["Apnoea management", "Vaccination history"] }, vitalsMod: { hr: 160, bpSys: 80, spO2: 88, rr: 60 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['Oxygen', 'Antibiotics'], recommendedActions: ['Obs', 'Oxygen', 'Antibiotics', 'Suction'] },
      { id: 'PA020', title: 'Measles', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(1, 5), patientProfileTemplate: "A {age}-year-old. High fever, coryza, conjunctivitis, rash.", presentingComplaint: 'Fever & Rash', instructorBrief: { progression: "Pneumonia or Encephalitis.", interventions: ["Vitamin A", "Isolation", "Supportive"], learningObjectives: ["Koplik spots", "Isolation protocols"] }, vitalsMod: { hr: 140, bpSys: 95, spO2: 94, temp: 40.0 }, deterioration: { active: true, rate: 0.05, type: 'respiratory' }, recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Analgesia', 'VitaminA'] },
      { id: 'PA021', title: 'Inborn Error of Metabolism', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => 0, patientProfileTemplate: "A 1-week-old. Encephalopathic, poor feeding, seizures.", presentingComplaint: 'Seizures', instructorBrief: { progression: "Hyperammonemia. Brain injury.", interventions: ["Stop feeds", "Glucose 10%", "Ammonia Scavengers"], learningObjectives: ["Ammonia measurement", "Sepsis mimic"] }, vitalsMod: { hr: 160, bpSys: 70, spO2: 95, gcs: 8 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['InsulinDextrose'], recommendedActions: ['Obs', 'IV Access', 'InsulinDextrose'] },
      { id: 'PA022', title: 'Supracondylar Fracture', category: 'Trauma', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => getRandomInt(4, 8), patientProfileTemplate: "A {age}-year-old. Fall from monkey bars. Pale hand.", presentingComplaint: 'Arm Injury', instructorBrief: { progression: "Vascular compromise (Brachial artery).", interventions: ["Urgent Reduction", "Orthopaedics"], learningObjectives: ["Gartland classification", "Pulse check"] }, vitalsMod: { hr: 120, bpSys: 100, spO2: 99 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Reduction'], recommendedActions: ['Obs', 'IV Access', 'Reduction', 'Surgery', 'Analgesia'] },
      { id: 'PA023', title: 'Severe Neonatal Jaundice', category: 'Medical', ageRange: 'Paediatric', acuity: 'Majors', ageGenerator: () => 0, patientProfileTemplate: "A 4-day-old. Yellow down to toes. Lethargic.", presentingComplaint: 'Jaundice', instructorBrief: { progression: "Kernicterus.", interventions: ["Phototherapy", "Exchange Transfusion (if critical)", "Hydration"], learningObjectives: ["Bilirubin nomogram", "Kernicterus signs"] }, vitalsMod: { hr: 150, bpSys: 70, spO2: 98, gcs: 12 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, recommendedActions: ['Obs', 'Fluids', 'Phototherapy'] },
      { id: 'PA024', title: 'Paediatric Scald', category: 'Trauma', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 3), patientProfileTemplate: "A {age}-year-old. Pulled kettle over. Burns to chest and face.", presentingComplaint: 'Burns', instructorBrief: { progression: "Airway oedema. Hypothermia.", interventions: ["Cooling (20 mins)", "Cling Film", "Ketamine"], learningObjectives: ["Lund and Browder", "Cooling limits"] }, vitalsMod: { hr: 160, bpSys: 90, spO2: 95, temp: 36.5 }, deterioration: { active: true, rate: 0.1, type: 'airway' }, stabilisers: ['Analgesia', 'Warming'], recommendedActions: ['Obs', 'IV Access', 'Analgesia', 'Warming', 'Ketamine', 'Fluids', 'Cooling'] },
      { id: 'PA025', title: 'Complex Febrile Convulsion', category: 'Medical', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 4), patientProfileTemplate: "A {age}-year-old. Seizure > 15 mins. Fever.", presentingComplaint: 'Seizure', instructorBrief: { progression: "Status Epilepticus.", interventions: ["Benzodiazepines", "Paracetamol (for comfort)", "Source hunt"], learningObjectives: ["Simple vs Complex", "Meningitis exclusion"] }, vitalsMod: { hr: 150, bpSys: 95, spO2: 92, temp: 39.8, gcs: 3 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Midazolam', 'Lorazepam'], recommendedActions: ['Obs', 'Oxygen', 'Midazolam', 'Lorazepam', 'Paracetamol'] },
      { id: 'OB009', title: 'Uterine Inversion', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Just delivered. Mass at introitus. Shock.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Neurogenic and Haemorrhagic Shock.", interventions: ["Johnson Manoeuvre (Push back)", "Stop Oxytocin", "Fluids"], learningObjectives: ["Do not pull cord", "Reinvert immediately"] }, vitalsMod: { hr: 130, bpSys: 70, spO2: 94 }, deterioration: { active: true, rate: 0.15, type: 'shock' }, stabilisers: ['Fluids', 'Surgery'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Surgery', 'Manoeuvres'] },
      { id: 'OB010', title: 'Placental Abruption', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "34 weeks pregnant. Severe constant abdo pain. 'Woody' uterus.", presentingComplaint: 'Abdo Pain', instructorBrief: { progression: "Fetal distress and DIC.", interventions: ["Emergency C-Section", "Blood Products"], learningObjectives: ["Concealed abruption", "Pain disproportionate to bleed"] }, vitalsMod: { hr: 110, bpSys: 100, spO2: 98 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Delivery', 'Blood'], recommendedActions: ['Obs', 'IV Access', 'Delivery', 'Blood', 'Analgesia'] },
      { id: 'OB011', title: 'Placenta Previa Bleed', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "32 weeks pregnant. Sudden painless heavy vaginal bleeding.", presentingComplaint: 'PV Bleed', instructorBrief: { progression: "Exsanguination.", interventions: ["No PV Exam", "Blood", "C-Section"], learningObjectives: ["Painless bleed = Previa", "Digital exam contraindication"] }, vitalsMod: { hr: 120, bpSys: 90, spO2: 96 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Blood', 'Delivery'], recommendedActions: ['Obs', 'IV Access', 'Blood', 'Delivery'] },
      { id: 'OB012', title: 'Hyperemesis Gravidarum', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 35), patientProfileTemplate: "10 weeks pregnant. Vomiting 20x day. Ketotic.", presentingComplaint: 'Vomiting', instructorBrief: { progression: "Wernicke's Encephalopathy. AKI.", interventions: ["Thiamine", "Fluids", "Antiemetics"], learningObjectives: ["Wernicke's prevention", "PUQE score"] }, vitalsMod: { hr: 110, bpSys: 100, spO2: 98, bm: 3.2 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Fluids', 'Pabrinex'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Pabrinex', 'Antiemetic'] },
      { id: 'OB013', title: 'Breech Delivery', category: 'Obstetrics & Gynae', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "Term pregnancy. Legs delivered, head stuck.", presentingComplaint: 'Imminent Delivery', instructorBrief: { progression: "Head entrapment. Fetal hypoxia.", interventions: ["Mauriceau-Smellie-Veit", "Lovset Manoeuvre"], learningObjectives: ["Breech manoeuvres", "Hands off breech"] }, vitalsMod: { hr: 110, bpSys: 130, spO2: 98 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Delivery'], recommendedActions: ['Obs', 'IV Access', 'Delivery', 'Manoeuvres'] },
      { id: 'TX006', title: 'Calcium Channel Blocker OD', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Amlodipine overdose. Hypotensive and hyperglycaemic.", presentingComplaint: 'Overdose', instructorBrief: { progression: "Refractory shock.", interventions: ["High Dose Insulin", "Calcium", "Vasopressors"], learningObjectives: ["Hyperglycaemia in CCB OD", "Insulin euglycaemia"] }, vitalsMod: { hr: 100, bpSys: 70, spO2: 96, bm: 18.0 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['InsulinDextrose', 'Calcium', 'Metaraminol'], recommendedActions: ['Obs', 'IV Access', 'InsulinDextrose', 'Calcium', 'Metaraminol', 'Glucagon', 'Lipid'] },
      { id: 'TX007', title: 'Salicylate Toxicity', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Aspirin overdose. Tinnitus and hyperventilation.", presentingComplaint: 'Overdose', instructorBrief: { progression: "Respiratory Alkalosis -> Metabolic Acidosis. Cerebral Oedema.", interventions: ["Urinary Alkalinisation (Bicarb)", "Dialysis"], learningObjectives: ["Uncoupling oxidative phosphorylation", "pH trapping"] }, vitalsMod: { hr: 110, bpSys: 120, spO2: 98, rr: 35, temp: 38.5 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, vbgClinicalState: "metabolic_acidosis_severe", recommendedActions: ['Obs', 'IV Access', 'Fluids', 'SodiumBicarb', 'Charcoal'] },
      { id: 'TX008', title: 'MDMA Hyperpyrexia', category: 'Toxicology', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(18, 30), patientProfileTemplate: "A {age}-year-old. Clubbing. Agitated, hot, seizure.", presentingComplaint: 'Seizure', instructorBrief: { progression: "Hyperthermia, Rhabdomyolysis, Hyponatremia.", interventions: ["Active Cooling", "Benzodiazepines", "Dantrolene?"], learningObjectives: ["Serotonin syndrome features", "Cooling urgency"] }, vitalsMod: { hr: 160, bpSys: 170, spO2: 94, temp: 41.5, gcs: 8 }, deterioration: { active: true, rate: 0.15, type: 'neuro' }, stabilisers: ['Warming', 'Midazolam'], recommendedActions: ['Obs', 'IV Access', 'Warming', 'Midazolam', 'Fluids', 'Dantrolene'] }, 
      { id: 'TX009', title: 'Cocaine Chest Pain', category: 'Toxicology', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "A {age}-year-old. Cocaine use. Severe chest pain.", presentingComplaint: 'Chest Pain', instructorBrief: { progression: "Coronary vasospasm vs Dissection.", interventions: ["Benzodiazepines", "GTN", "Phentolamine", "NO Beta Blockers"], learningObjectives: ["Unopposed alpha stimulation", "Benzo utility"] }, vitalsMod: { hr: 130, bpSys: 180, spO2: 98 }, deterioration: { active: true, rate: 0.05, type: 'cardiac' }, stabilisers: ['Midazolam', 'GTN'], recommendedActions: ['Obs', 'IV Access', 'Midazolam', 'GTN', 'Phentolamine', 'Analgesia'] },
      { id: 'TX010', title: 'Adder Bite', category: 'Toxicology', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(10, 60), patientProfileTemplate: "A {age}-year-old. Walking in dunes. Bitten on hand. Swelling extending to forearm.", presentingComplaint: 'Snake Bite', instructorBrief: { progression: "Anaphylaxis or spreading venom.", interventions: ["Immobilise Limb", "Antivenom (if systemic)", "IV Fluids"], learningObjectives: ["UK Adder management", "Antivenom indications"] }, vitalsMod: { hr: 110, bpSys: 100, spO2: 98 }, deterioration: { active: true, rate: 0.05, type: 'shock' }, stabilisers: ['Fluids'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Analgesia', 'Splinting'] },
      { id: 'TX011', title: 'Drowning (Secondary)', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Pulled from river. Initially fine, now breathless.", presentingComplaint: 'Dyspnoea', instructorBrief: { progression: "Surfactant wash-out. ARDS.", interventions: ["CPAP/PEEP", "Warming"], learningObjectives: ["Non-cardiogenic pulmonary oedema", "C-spine in drowning"] }, vitalsMod: { hr: 110, bpSys: 110, spO2: 86, rr: 30, temp: 35.0 }, deterioration: { active: true, rate: 0.1, type: 'respiratory' }, stabilisers: ['CPAP', 'Oxygen'], recommendedActions: ['Obs', 'IV Access', 'CPAP', 'Oxygen', 'Warming'] },
      { id: 'TX012', title: 'Heat Stroke', category: 'Medical', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old runner. Marathon day. Collapsed, hot dry skin.", presentingComplaint: 'Collapse', instructorBrief: { progression: "Multiorgan failure.", interventions: ["Rapid Cooling (Ice/Water)", "Fluids"], learningObjectives: ["Heat stroke vs exhaustion", "Cooling methods"] }, vitalsMod: { hr: 140, bpSys: 90, spO2: 96, temp: 41.0, gcs: 9 }, deterioration: { active: true, rate: 0.1, type: 'shock' }, stabilisers: ['Fluids'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Cooling'] },
      { id: 'PS001', title: 'Neuroleptic Malignant Syndrome', category: 'Psychiatric', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Schizophrenic. Rigid, fever, confused.", presentingComplaint: 'Confusion & Rigidity', instructorBrief: { progression: "Rhabdomyolysis and Autonomic Instability.", interventions: ["Stop Antipsychotics", "Bromocriptine/Dantrolene", "Fluids"], learningObjectives: ["NMS vs Serotonin Syndrome", "Lead pipe rigidity"] }, vitalsMod: { hr: 120, bpSys: 160, spO2: 96, temp: 39.5, gcs: 11 }, deterioration: { active: true, rate: 0.1, type: 'neuro' }, stabilisers: ['Fluids'], recommendedActions: ['Obs', 'IV Access', 'Fluids', 'Lorazepam', 'Dantrolene'] },
      { id: 'PS002', title: 'Lithium Toxicity', category: 'Psychiatric', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(30, 60), patientProfileTemplate: "A {age}-year-old. Coarse tremor, vomiting, ataxia.", presentingComplaint: 'Tremor & Vomiting', instructorBrief: { progression: "Seizures and renal failure.", interventions: ["Aggressive Hydration", "Dialysis (if severe)"], learningObjectives: ["Chronic vs Acute toxicity", "Dialysis indications"] }, vitalsMod: { hr: 90, bpSys: 130, spO2: 98, gcs: 14 }, deterioration: { active: true, rate: 0.05, type: 'neuro' }, stabilisers: ['Fluids'], recommendedActions: ['Obs', 'IV Access', 'Fluids'] },
      { id: 'PS003', title: 'Catatonia', category: 'Psychiatric', ageRange: 'Adult', acuity: 'Majors', ageGenerator: () => getRandomInt(20, 50), patientProfileTemplate: "A {age}-year-old. Mute, immobile, holding awkward postures.", presentingComplaint: 'Unresponsive', instructorBrief: { progression: "Malnutrition/DVT risks.", interventions: ["Lorazepam Trial", "Exclude organic cause"], learningObjectives: ["Benzodiazepine response", "Waxy flexibility"] }, vitalsMod: { hr: 80, bpSys: 120, spO2: 98, gcs: 10 }, deterioration: { active: false, rate: 0 }, stabilisers: ['Lorazepam'], recommendedActions: ['Obs', 'IV Access', 'Lorazepam', 'Fluids'] }, 
      
      // --- ADULT CARDIAC ARRESTS ---
      { id: 'CA_A01', title: 'Adult - VF Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 70), patientProfileTemplate: "Adult Male. Collapsed. Witnessed.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Refractory VF.", interventions: ["CPR", "Shock", "Adrenaline", "Amiodarone"], learningObjectives: ["ALS Algorithm"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VF", findings: "Coarse VF" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV', 'Amiodarone'] },
    { id: 'CA_A02', title: 'Adult - Pulseless VT', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 70), patientProfileTemplate: "Adult Female. Palpitations then collapse.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Pulseless VT. Treat as VF.", interventions: ["CPR", "Shock", "Adrenaline", "Amiodarone"], learningObjectives: ["Shockable rhythms"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VT", findings: "Monomorphic VT (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV', 'Amiodarone'] },
    { id: 'CA_A03', title: 'Adult - PEA Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(50, 70), patientProfileTemplate: "Adult Male. DIB for 2 days. Sudden collapse.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "PEA. 4Hs & 4Ts.", interventions: ["CPR", "Adrenaline", "Fluids", "Airway"], learningObjectives: ["Reversible causes"] }, vitalsMod: { hr: 40, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "Slow nodal rhythm (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV', 'Fluids'] },
    { id: 'CA_A04', title: 'Adult - Asystole', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(70, 90), patientProfileTemplate: "Adult Female. Found unresponsive.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Asystole. Poor prognosis.", interventions: ["CPR", "Adrenaline"], learningObjectives: ["Confirmation of death"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "Asystole", findings: "Flatline" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV'] },
    { id: 'CA_A05', title: 'Adult - Traumatic Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "Adult Male. Stabbed chest. Lost output on arrival.", presentingComplaint: 'Traumatic Arrest', instructorBrief: { progression: "HOT protocol. Thoracotomy?", interventions: ["Thoracotomy", "Finger Thoracostomy", "Blood"], learningObjectives: ["Traumatic cardiac arrest algorithm"] }, vitalsMod: { hr: 40, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "Narrow complex PEA" }, recommendedActions: ['Obs', 'CPR', 'Thoracotomy', 'FingerThoracostomy', 'Blood'] },

    // --- PAEDIATRIC CARDIAC ARRESTS ---
    { id: 'CA_P01', title: 'Paediatric - VF Arrest', category: 'Cardiac Arrest', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(8, 14), patientProfileTemplate: "Child. Electrocution/Congenital Heart. Collapsed.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Rare in kids. Shock 4J/kg.", interventions: ["CPR", "Shock", "Adrenaline", "Amiodarone"], learningObjectives: ["Paeds Defib Dosing"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VF", findings: "VF" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV', 'Amiodarone'] },
    { id: 'CA_P02', title: 'Paediatric - Pulseless VT', category: 'Cardiac Arrest', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(10, 16), patientProfileTemplate: "Adolescent. Collapsed during sport.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Shockable rhythm.", interventions: ["CPR", "Shock"], learningObjectives: ["HOCM presentation"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VT", findings: "Wide Complex Tachycardia (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV'] },
    { id: 'CA_P03', title: 'Paediatric - PEA Arrest', category: 'Cardiac Arrest', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(1, 6), patientProfileTemplate: "Child. Choking episode then limp.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Hypoxic arrest. Airway is priority.", interventions: ["Oxygen", "Airway", "CPR", "Adrenaline"], learningObjectives: [" hypoxia as cause"] }, vitalsMod: { hr: 40, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "Sinus Bradycardia (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV', 'Oxygen', 'Bagging'] },
    { id: 'CA_P04', title: 'Paediatric - Asystole', category: 'Cardiac Arrest', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(0, 1), patientProfileTemplate: "Infant. SIDS presentation. Cold.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Asystole.", interventions: ["CPR", "Adrenaline"], learningObjectives: ["SIDS management"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "Asystole", findings: "Asystole" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV'] },
    { id: 'CA_P05', title: 'Paediatric - Traumatic Arrest', category: 'Cardiac Arrest', ageRange: 'Paediatric', acuity: 'Resus', ageGenerator: () => getRandomInt(4, 10), patientProfileTemplate: "Child. RTC. Run over.", presentingComplaint: 'Traumatic Arrest', instructorBrief: { progression: "Hypovolaemia/Tension. Poor prognosis.", interventions: ["Fluid/Blood", "Decompression"], learningObjectives: ["Paeds trauma arrest"] }, vitalsMod: { hr: 60, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "PEA" }, recommendedActions: ['Obs', 'CPR', 'Blood', 'Fluids', 'Needle'] },

    // --- ELDERLY CARDIAC ARRESTS ---
    { id: 'CA_E01', title: 'Elderly - VF Arrest', category: 'Cardiac Arrest', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "Elderly. Chest pain then collapse.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Standard ALS.", interventions: ["CPR", "Defib"], learningObjectives: ["ALS in elderly"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VF", findings: "Fine VF" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'AdrenalineIV'] },
    { id: 'CA_E02', title: 'Elderly - Pulseless VT', category: 'Cardiac Arrest', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "Elderly. Known heart failure.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Scar related VT.", interventions: ["CPR", "Defib"], learningObjectives: ["ICD management"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VT", findings: "VT (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'Defib'] },
    { id: 'CA_E03', title: 'Elderly - PEA Arrest', category: 'Cardiac Arrest', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(80, 95), patientProfileTemplate: "Elderly. 'Unwell' for 3 days.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "Sepsis/Hypovolaemia.", interventions: ["CPR", "Adrenaline", "Fluids"], learningObjectives: ["DNACPR decisions"] }, vitalsMod: { hr: 50, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "AF (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV', 'Fluids'] },
    { id: 'CA_E04', title: 'Elderly - Asystole', category: 'Cardiac Arrest', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(85, 99), patientProfileTemplate: "Elderly. Found cold in bed.", presentingComplaint: 'Cardiac Arrest', instructorBrief: { progression: "End of life.", interventions: ["Confirm death?"], learningObjectives: ["Recognition of life extinct"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "Asystole", findings: "Asystole" }, recommendedActions: ['Obs', 'CPR'] },
    { id: 'CA_E05', title: 'Elderly - Traumatic Arrest', category: 'Cardiac Arrest', ageRange: 'Elderly', acuity: 'Resus', ageGenerator: () => getRandomInt(75, 90), patientProfileTemplate: "Elderly. Fall down stairs. Head injury.", presentingComplaint: 'Traumatic Arrest', instructorBrief: { progression: "Cushing's/Brain herniation.", interventions: ["Airway", "CPR"], learningObjectives: ["Futility in elderly trauma arrest"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "Agonal Rhythm" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV'] },

    // --- OBSTETRIC CARDIAC ARRESTS ---
    { id: 'CA_O01', title: 'Obstetric - VF Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(25, 40), patientProfileTemplate: "Pregnant (36 weeks). Known cardiomyopathy. Collapsed.", presentingComplaint: 'Maternal Arrest', instructorBrief: { progression: "Perimortem C-Section indicated.", interventions: ["CPR", "Defib", "Hysterotomy", "Tilt"], learningObjectives: ["Maternal Resus"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VF", findings: "VF" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'Hysterotomy'] },
    { id: 'CA_O02', title: 'Obstetric - Pulseless VT', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(25, 40), patientProfileTemplate: "Pregnant (30 weeks). Palpitations.", presentingComplaint: 'Maternal Arrest', instructorBrief: { progression: "Standard shockable algorithm + C-Section.", interventions: ["CPR", "Defib", "Hysterotomy"], learningObjectives: ["Defib safety in pregnancy"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "VT", findings: "VT (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'Defib', 'Hysterotomy'] },
    { id: 'CA_O03', title: 'Obstetric - PEA Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "Pregnant (38 weeks). Sudden collapse. SOB.", presentingComplaint: 'Maternal Arrest', instructorBrief: { progression: "PE/Amniotic Fluid Embolism.", interventions: ["CPR", "Thrombolysis?", "Hysterotomy"], learningObjectives: ["AFE management"] }, vitalsMod: { hr: 120, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "Sinus Tachy (No Pulse)" }, recommendedActions: ['Obs', 'CPR', 'AdrenalineIV', 'Hysterotomy'] },
    { id: 'CA_O04', title: 'Obstetric - Asystole', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "Pregnant. Eclamptic seizure then arrest.", presentingComplaint: 'Maternal Arrest', instructorBrief: { progression: "Hypoxia/Intracranial bleed.", interventions: ["CPR", "Airway", "Hysterotomy"], learningObjectives: ["Eclampsia arrest"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "Asystole", findings: "Asystole" }, recommendedActions: ['Obs', 'CPR', 'Hysterotomy', 'MagSulph'] },
    { id: 'CA_O05', title: 'Obstetric - Traumatic Arrest', category: 'Cardiac Arrest', ageRange: 'Adult', acuity: 'Resus', ageGenerator: () => getRandomInt(20, 40), patientProfileTemplate: "Pregnant (34 weeks). RTC steering wheel injury.", presentingComplaint: 'Traumatic Maternal Arrest', instructorBrief: { progression: "Uterine rupture/Splenic rupture.", interventions: ["Hysterotomy", "Massive Transfusion"], learningObjectives: ["Trauma in pregnancy"] }, vitalsMod: { hr: 0, bpSys: 0, spO2: 0, gcs: 3 }, deterioration: { active: false }, ecg: { type: "PEA", findings: "PEA" }, recommendedActions: ['Obs', 'CPR', 'Blood', 'Hysterotomy'] },
    ];

window.processScenarios = () => {
    // If RAW_SCENARIOS is incomplete in this snippet, you must ensure the full array is present in the final file.
    // Assuming the full array from your previous upload is present.
    // I will use a fallback to ensure the app doesn't break if the array is short in this snippet.
    const scenarios = window.RAW_SCENARIOS || []; 
    
    return scenarios.map(s => {
        let kit = ['Monitoring', 'IV Access'];
        let links = [];

        if (s.acuity === 'Resus') kit = [...kit, 'Defibrillator', 'Airway Trolley', 'Drugs Bag', 'IO Drill', 'Ultrasound'];
        if (s.category === 'Trauma') kit = [...kit, 'Pelvic Binder', 'Splints', 'TXA', 'Blood Warmer'];
        if (s.ageRange === 'Paediatric') kit = [...kit, 'Broselow Tape', 'Paeds Drug Calc'];
        if (s.category === 'Obstetrics & Gynae') kit = [...kit, 'Obs Delivery Pack', 'Neonatal Resuscatire'];

        if (s.ageRange === 'Paediatric') {
            links.push({ label: 'RCUK Paeds Guidelines 2025', url: 'https://www.resus.org.uk/professional-library/2025-resuscitation-guidelines' });
            links.push({ label: 'APLS Algorithms', url: 'https://www.resus.org.uk/sites/default/files/2025-07/RCUK%20Paediatric%20emergency%20algorithms%20and%20resources%20Jul%2025%20V3.1.pdf' });
        } else {
            links.push({ label: 'RCUK Adult ALS 2025', url: 'https://www.resus.org.uk/professional-library/2025-resuscitation-guidelines/adult-advanced-life-support-guidelines' });
            links.push({ label: 'DAS Intubation 2025', url: 'https://das.uk.com/new-das-2025-intubation-guidelines/' });
        }
        if (s.category === 'Trauma') links.push({ label: 'NICE Trauma (NG39)', url: 'https://www.nice.org.uk/guidance/ng39' });
        if (s.category === 'Toxicology') links.push({ label: 'TOXBASE', url: 'https://www.toxbase.org/' });
        if (s.title.includes('Sepsis')) links.push({ label: 'Sepsis Trust Tools', url: 'https://sepsistrust.org/professional-resources/clinical-tools/' });
        if (s.category === 'Obstetrics & Gynae') links.push({ label: 'RCOG Guidelines', url: 'https://www.rcog.org.uk/guidance/browse-all-guidance/' });

        const mapKeys = (list) => list ? list.map(item => {
            if (item === 'Adrenaline') return (s.acuity === 'Resus' && !s.title.includes('Anaphylaxis')) ? 'AdrenalineIV' : 'AdrenalineIM';
            if (item === 'Magnesium') return 'MagSulph';
            if (item === 'Amio') return 'Amiodarone';
            if (item === 'Calcium') return 'Calcium';
            return item;
        }) : [];

        const safeRecommended = mapKeys(s.recommendedActions || []);
        const safeStabilisers = mapKeys(s.stabilisers || []);

        let improved = { ...s, ...(s.evolution ? s.evolution.improved : {}) };
        let deteriorated = { ...s, ...(s.evolution ? s.evolution.deteriorated : {}) };

        if (s.chestXray) {
            let newCXR = s.chestXray.findings;
            if (newCXR.includes("Pneumothorax") || s.title.includes("Pneumothorax") || s.title.includes("Stab")) {
                newCXR = "Intercostal drain seen in good position. Lung re-expanded. No residual pneumothorax.";
            } else if (newCXR.includes("tube") || s.title.includes("Intubation")) {
                newCXR = "ETT tip in good position above carina. Lung fields clear.";
            } else if (newCXR.includes("Normal")) {
                newCXR = "Remains Normal.";
            } else {
                newCXR = "Findings unchanged (radiological lag).";
            }
            improved.chestXray = { findings: newCXR };
            deteriorated.chestXray = { findings: s.chestXray.findings + " Worsening appearance." };
        }

        if (s.ecg) {
            let newECG = s.ecg ? s.ecg.findings : "Normal";
            let newType = s.ecg.type;
            if (s.ecg.type === "STEMI") {
                newECG = "ST segments resolving. Q waves developing.";
                newType = "Sinus Rhythm (Post-MI)";
            } else if (["VT", "VF", "SVT", "AF"].includes(s.ecg.type)) {
                newECG = "Reverted to Sinus Rhythm.";
                newType = "Sinus Rhythm";
            } else if (s.title.includes("Hyperkalaemia")) {
                newECG = "T waves normalising. QRS narrowing.";
            }
            improved.ecg = { type: newType, findings: newECG };
            deteriorated.ecg = { type: s.ecg.type, findings: "Worsening changes / Arrythmia persistence." };
        }

        if (s.vbg) {
            const improvePh = (val) => val < 7.35 ? val + 0.1 : val;
            const worsenPh = (val) => val - 0.1;
            improved.vbg = { ...s.vbg, pH: improvePh(s.vbg.pH), Lac: Math.max(1, s.vbg.Lac / 2), K: s.vbg.K > 5.5 ? 5.0 : s.vbg.K };
            deteriorated.vbg = { ...s.vbg, pH: worsenPh(s.vbg.pH), Lac: s.vbg.Lac + 2 };
        }

        return {
            ...s,
            recommendedActions: safeRecommended, 
            stabilisers: safeStabilisers,       
            equipment: s.instructorBrief.equipment || kit, 
            learningLinks: s.learningLinks || links,
            evolution: { improved, deteriorated }
        };
    });
};

window.ALL_SCENARIOS = window.processScenarios();
